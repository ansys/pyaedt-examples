{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "962061f5",
   "metadata": {},
   "source": [
    "# Circuit Netlist to Schematic\n",
    "\n",
    "This example shows how to create components\n",
    "in the circuit schematic editor from a netlist file.\n",
    "\n",
    "Note that HSPICE files are fully supported and that broad coverage is provided for many other formats.\n",
    "\n",
    "Keywords: **Circuit**, **netlist**."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5f1d8f5d",
   "metadata": {},
   "source": [
    "## Perform imports and define constants\n",
    "\n",
    "Import the required packages."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cc90f7fa",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import tempfile\n",
    "import time\n",
    "\n",
    "import ansys.aedt.core\n",
    "from ansys.aedt.core.examples.downloads import download_netlist"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "55c5e034",
   "metadata": {},
   "source": [
    "## Define constants."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4be66f57",
   "metadata": {},
   "outputs": [],
   "source": [
    "AEDT_VERSION = \"2025.2\"\n",
    "NG_MODE = False  # Open AEDT UI when it is launched."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "57bfb3e8",
   "metadata": {},
   "source": [
    "## Create temporary directory\n",
    "\n",
    "Create a temporary directory where downloaded data or\n",
    "dumped data can be stored.\n",
    "If you'd like to retrieve the project data for subsequent use,\n",
    "the temporary folder name is given by ``temp_folder.name``."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f9d07723",
   "metadata": {},
   "outputs": [],
   "source": [
    "temp_folder = tempfile.TemporaryDirectory(suffix=\".ansys\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b42e457c",
   "metadata": {},
   "source": [
    "## Launch AEDT with Circuit\n",
    "\n",
    "Launch AEDT with Circuit. The `ansys.aedt.core.Desktop` class initializes AEDT\n",
    "and starts it on the specified version in the specified graphical mode."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "188d71d7",
   "metadata": {},
   "outputs": [],
   "source": [
    "netlist = download_netlist(local_path=temp_folder.name)\n",
    "circuit = ansys.aedt.core.Circuit(\n",
    "    project=os.path.join(temp_folder.name, \"NetlistExample\"),\n",
    "    version=AEDT_VERSION,\n",
    "    non_graphical=NG_MODE,\n",
    "    new_desktop=True,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "139d1f1b",
   "metadata": {},
   "source": [
    "## Define a parameter\n",
    "\n",
    "Specify the voltage as a parameter."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d1711eab",
   "metadata": {},
   "outputs": [],
   "source": [
    "circuit[\"Voltage\"] = \"5\""
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f881625f",
   "metadata": {},
   "source": [
    "## Create schematic from netlist file\n",
    "\n",
    "Create a schematic from a netlist file. The ``create_schematic_from_netlist()``\n",
    "method reads the netlist file and parses it. All components are parsed,\n",
    "but only these categories are mapped: R, L, C, Q, U, J, V, and I."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e1eb9558",
   "metadata": {},
   "outputs": [],
   "source": [
    "circuit.create_schematic_from_netlist(netlist)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a2266d31",
   "metadata": {},
   "source": [
    "## Release AEDT\n",
    "\n",
    "Release AEDT and close the example."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "07597240",
   "metadata": {},
   "outputs": [],
   "source": [
    "circuit.save_project()\n",
    "circuit.release_desktop()\n",
    "# Wait 3 seconds to allow AEDT to shut down before cleaning the temporary directory.\n",
    "time.sleep(3)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c05d75a1",
   "metadata": {},
   "source": [
    "## Clean up\n",
    "\n",
    "All project files are saved in the folder ``temp_folder.name``. If you've run this example as a Jupyter notebook, you\n",
    "can retrieve those project files. The following cell removes all temporary files, including the project folder."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d1b91015",
   "metadata": {},
   "outputs": [],
   "source": [
    "temp_folder.cleanup()"
   ]
  }
 ],
 "metadata": {
  "jupytext": {
   "cell_metadata_filter": "-all",
   "main_language": "python",
   "notebook_metadata_filter": "-all"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
