{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "a82b4171",
   "metadata": {},
   "source": [
    "# HFSS Layout UI modification\n",
    "\n",
    "This example shows how to modify the HFSS 3D Layout UI.\n",
    "<img src=\"_static/user_interface.png\" width=\"600\">\n",
    "\n",
    "Keywords: **HFSS 3D Layout**, **UI**, **user interface**."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1f5210bb",
   "metadata": {},
   "source": [
    "## Perform imports and define constants\n",
    "Perform required imports."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0a5e3ed1",
   "metadata": {},
   "outputs": [],
   "source": [
    "import sys\n",
    "import tempfile\n",
    "import time\n",
    "\n",
    "from ansys.aedt.core import Hfss3dLayout\n",
    "from ansys.aedt.core.examples.downloads import download_file"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1d42b537",
   "metadata": {},
   "source": [
    "Define constants."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c8a9f1b7",
   "metadata": {},
   "outputs": [],
   "source": [
    "AEDT_VERSION = \"2025.2\"\n",
    "NUM_CORES = 4\n",
    "NG_MODE = True  # Open AEDT UI when it is launched."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5c66c2b0",
   "metadata": {},
   "source": [
    "Check if AEDT is launched in graphical mode."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "41e11ad7",
   "metadata": {},
   "outputs": [],
   "source": [
    "if not NG_MODE:\n",
    "    print(\"Warning: This example requires graphical mode enabled.\")\n",
    "    sys.exit()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "12fc47ac",
   "metadata": {},
   "source": [
    "Download example board."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "195da050",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "temp_folder = tempfile.TemporaryDirectory(suffix=\".ansys\")\n",
    "aedb = download_file(source=\"edb/ANSYS-HSD_V1.aedb\", local_path=temp_folder.name)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5e2a0688",
   "metadata": {},
   "source": [
    "## Launch HFSS 3D Layout\n",
    "\n",
    "Initialize AEDT and launch HFSS 3D Layout."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e101e201",
   "metadata": {},
   "outputs": [],
   "source": [
    "h3d = Hfss3dLayout(aedb, version=AEDT_VERSION, non_graphical=NG_MODE, new_desktop=True)\n",
    "h3d.save_project()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cdd89534",
   "metadata": {},
   "source": [
    "## Net visibility\n",
    "Hide all nets."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "70b2da73",
   "metadata": {},
   "outputs": [],
   "source": [
    "h3d.modeler.change_net_visibility(visible=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "65be3fc0",
   "metadata": {},
   "source": [
    "Show two specified nets."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b4258fc",
   "metadata": {},
   "outputs": [],
   "source": [
    "h3d.modeler.change_net_visibility([\"5V\", \"1V0\"], visible=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fd20c922",
   "metadata": {},
   "source": [
    "Show all layers."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a035ff2d",
   "metadata": {},
   "outputs": [],
   "source": [
    "for layer in h3d.modeler.layers.all_signal_layers:\n",
    "    layer.is_visible = True"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "694b15d7",
   "metadata": {},
   "source": [
    "Change the layer color."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0c1eb880",
   "metadata": {},
   "outputs": [],
   "source": [
    "layer = h3d.modeler.layers.layers[h3d.modeler.layers.layer_id(\"1_Top\")]\n",
    "layer.set_layer_color(0, 255, 0)\n",
    "h3d.modeler.fit_all()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d5df6ee9",
   "metadata": {},
   "source": [
    "## Disable component visibility"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "60574d9f",
   "metadata": {},
   "source": [
    "Disable component visibility for the ``\"1_Top\"`` and ``\"16_Bottom\"`` layers."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9e240743",
   "metadata": {},
   "outputs": [],
   "source": [
    "top = h3d.modeler.layers.layers[h3d.modeler.layers.layer_id(\"1_Top\")]\n",
    "top.is_visible_component = False"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "77591ed6",
   "metadata": {},
   "outputs": [],
   "source": [
    "bot = h3d.modeler.layers.layers[h3d.modeler.layers.layer_id(\"16_Bottom\")]\n",
    "bot.is_visible_component = False"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "32fd51c1",
   "metadata": {},
   "source": [
    "## Display the layout\n",
    "\n",
    "Fit all so that you can visualize all."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b5620294",
   "metadata": {},
   "outputs": [],
   "source": [
    "h3d.modeler.fit_all()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b463c8b3",
   "metadata": {},
   "source": [
    "## Release AEDT"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "31f9dbd7",
   "metadata": {},
   "outputs": [],
   "source": [
    "h3d.save_project()\n",
    "h3d.release_desktop()\n",
    "# Wait 3 seconds to allow AEDT to shut down before cleaning the temporary directory.\n",
    "time.sleep(3)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1166f3b4",
   "metadata": {},
   "source": [
    "## Clean up\n",
    "\n",
    "All project files are saved in the folder ``temp_folder.name``.\n",
    "If you've run this example as a Jupyter notebook, you\n",
    "can retrieve those project files. The following cell\n",
    "removes all temporary files, including the project folder."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "05c67daa",
   "metadata": {},
   "outputs": [],
   "source": [
    "temp_folder.cleanup()"
   ]
  }
 ],
 "metadata": {
  "jupytext": {
   "cell_metadata_filter": "-all",
   "main_language": "python",
   "notebook_metadata_filter": "-all"
  },
  "nbsphinx": {
   "execute": "never"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
