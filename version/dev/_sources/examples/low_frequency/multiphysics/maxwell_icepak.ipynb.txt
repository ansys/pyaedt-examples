{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "881788c8",
   "metadata": {},
   "source": [
    "# Maxwell 3D-Icepak electrothermal analysis\n",
    "\n",
    "This example uses PyAEDT to set up a simple Maxwell design consisting of a coil and a ferrite core.\n",
    "Coil current is set to 100A, and coil resistance and ohmic loss are analyzed.\n",
    "Ohmic loss is mapped to Icepak, and a thermal analysis is performed.\n",
    "Icepak calculates a temperature distribution, and it is mapped back to Maxwell (2-way coupling).\n",
    "Coil resistance and ohmic loss are analyzed again in Maxwell. Results are printed in AEDT Message Manager.\n",
    "\n",
    "Keywords: **Multiphysics**, **Maxwell**, **Icepak**, **Wireless Charging**."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "828684d1",
   "metadata": {},
   "source": [
    "## Prerequisites\n",
    "\n",
    "### Perform imports"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a024fa12",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import tempfile\n",
    "import time\n",
    "\n",
    "import ansys.aedt.core  # Interface to Ansys Electronics Desktop\n",
    "from ansys.aedt.core.generic.constants import Axis"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "54f47815",
   "metadata": {},
   "source": [
    "### Define constants\n",
    "\n",
    "Constants help ensure consistency and avoid repetition throughout the example."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f2fd5922",
   "metadata": {},
   "outputs": [],
   "source": [
    "AEDT_VERSION = \"2025.2\"\n",
    "NG_MODE = False  # Open AEDT UI when it is launched."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "44304a19",
   "metadata": {},
   "source": [
    "### Create temporary directory\n",
    "\n",
    "Create a temporary working directory.\n",
    "The name of the working folder is stored in ``temp_folder.name``.\n",
    "\n",
    "> **Note:** The final cell in this example removes the temporary folder and\n",
    "> all contents. If you want to\n",
    "> retrieve the AEDT project and data, do so before executing the final cell in the notebook."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "372d5192",
   "metadata": {},
   "outputs": [],
   "source": [
    "temp_folder = tempfile.TemporaryDirectory(suffix=\".ansys\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1684ed3d",
   "metadata": {},
   "source": [
    "### Launch application\n",
    "\n",
    "The syntax for different applications in AEDT differ\n",
    "only in the name of the class. This example demonstrates the use of the\n",
    "``Maxwell3d`` and ``Icepak`` classes.\n",
    "\n",
    "> **Note:** An AEDT _Project_ is created when the ``Maxwell3d`` class is instantiated. An instance of\n",
    "> the ``Icepak`` class will be used later to insert and simulate an\n",
    "> Icepak design to demonstrate\n",
    "> the coupled electrical-thermal workflow."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "81337853",
   "metadata": {},
   "outputs": [],
   "source": [
    "maxwell_design_name = \"1 Maxwell\"\n",
    "icepak_design_name = \"2 Icepak\"\n",
    "\n",
    "project_name = os.path.join(temp_folder.name, \"Maxwell-Icepak-2way-Coupling\")\n",
    "\n",
    "m3d = ansys.aedt.core.Maxwell3d(\n",
    "    project=project_name,\n",
    "    design=maxwell_design_name,\n",
    "    solution_type=\"EddyCurrent\",\n",
    "    version=AEDT_VERSION,\n",
    "    non_graphical=NG_MODE,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "96847e6f",
   "metadata": {},
   "source": [
    "## Model Preparation\n",
    "\n",
    "### Build the model\n",
    "\n",
    "Create the coil, coil terminal, core, and surrounding air region. The coil and core\n",
    "are created by drawing a rectangle and sweeping it about the z-axis."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2cb7e4fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "coil_origin = [70, 0, -11]  # [x, y, z] position of the rectangle origin.\n",
    "coil_xsection = [11, 110]  # [z-size, x-size]\n",
    "core_origin = [45, 0, -18]\n",
    "core_xsection = [7, 160]\n",
    "\n",
    "coil = m3d.modeler.create_rectangle(\n",
    "    orientation=\"XZ\", origin=coil_origin, sizes=coil_xsection, name=\"Coil\"\n",
    ")\n",
    "coil.sweep_around_axis(axis=Axis.Z)\n",
    "coil_terminal = m3d.modeler.create_rectangle(\n",
    "    orientation=\"XZ\", origin=coil_origin, sizes=coil_xsection, name=\"Coil_terminal\"\n",
    ")\n",
    "\n",
    "core = m3d.modeler.create_rectangle(\n",
    "    orientation=\"XZ\", origin=core_origin, sizes=core_xsection, name=\"Core\"\n",
    ")\n",
    "core.sweep_around_axis(axis=Axis.Z)\n",
    "\n",
    "# The air region should be sufficiently large to avoid interaction with the\n",
    "# coil magnetic field.\n",
    "\n",
    "region = m3d.modeler.create_region(pad_percent=[20, 20, 20, 20, 500, 100])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "79507e1c",
   "metadata": {},
   "source": [
    "#### Restore view\n",
    "\n",
    "If you are using PyAEDT with an interactive desktop, you may want to fit the visible view to fit the model.\n",
    "PyAEDT allows direct access to the native API for this command using the property `m3d.odesktop`.\n",
    "\n",
    "Uncomment and run the following cell if you are running PyAEDT interactively and would like to automatically fit the\n",
    "window to the model.\n",
    "\n",
    "> **Note:** Native API calls do not allow for introspection or follow PIP\n",
    "> syntax guidelines. Full documentation for the native API is available in\n",
    "> the built-in AEDT [help](https://ansyshelp.ansys.com/account/secured?returnurl=/Views/Secured/Electronics/v242/en//Subsystems/Maxwell/Subsystems/Maxwell%20Scripting/Maxwell%20Scripting.htm)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a8ef1baa",
   "metadata": {},
   "outputs": [],
   "source": [
    "# desktop=m3d.odesktop.RestoreWindow()  # Fit the active view\n",
    "# desktop = m3d.post.still_focus_oneditor()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "050f3d6f",
   "metadata": {},
   "source": [
    "### Create and assign material\n",
    "\n",
    "Define a new material for the AWG40 Litz wire copper strands:\n",
    "\n",
    "- Strand diameter = 0.08 mm\n",
    "- Number of parallel strands in the Litz wire = 24\n",
    "\n",
    "The built-in material \"ferrite\" will be assigned to the core.\n",
    "The material \"vacuum\" will be assigned to the outer region.\n",
    "\n",
    "You will also see the return value when\n",
    " ``True`` printed when material is successfully assigned."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bfb3c89a",
   "metadata": {},
   "outputs": [],
   "source": [
    "no_strands = 24\n",
    "strand_diameter = 0.08\n",
    "\n",
    "cu_litz = m3d.materials.duplicate_material(\"copper\", \"copper_litz\")\n",
    "cu_litz.stacking_type = \"Litz Wire\"\n",
    "cu_litz.wire_diameter = str(strand_diameter) + \"mm\"\n",
    "cu_litz.wire_type = \"Round\"\n",
    "cu_litz.strand_number = no_strands\n",
    "\n",
    "m3d.assign_material(region.name, \"vacuum\")\n",
    "m3d.assign_material(coil.name, \"copper_litz\")\n",
    "m3d.assign_material(core.name, \"ferrite\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "caa39d2f",
   "metadata": {},
   "source": [
    "### Define the source\n",
    "\n",
    "The coil carries 0.5 A and 20 turns."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c02ccd1f",
   "metadata": {},
   "outputs": [],
   "source": [
    "turns = 20\n",
    "wire_current = 0.5\n",
    "m3d.assign_coil([\"Coil_terminal\"], conductors_number=turns, name=\"Coil_terminal\")\n",
    "m3d.assign_winding(is_solid=False, current=wire_current * turns, name=\"Winding1\")\n",
    "\n",
    "m3d.add_winding_coils(assignment=\"Winding1\", coils=[\"Coil_terminal\"])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fef57486",
   "metadata": {},
   "source": [
    "### Assign mesh operations\n",
    "\n",
    "Mesh \"seeding\" is used to accelerate the auto-adaptive mesh refinement."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "60d0c723",
   "metadata": {},
   "outputs": [],
   "source": [
    "m3d.mesh.assign_length_mesh(\n",
    "    [\"Core\"], maximum_length=15, maximum_elements=None, name=\"Inside_Core\"\n",
    ")\n",
    "m3d.mesh.assign_length_mesh(\n",
    "    [\"Coil\"], maximum_length=30, maximum_elements=None, name=\"Inside_Coil\"\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e18d249d",
   "metadata": {},
   "source": [
    "### Set object temperature and enable feedback\n",
    "\n",
    "The impact of Joule heating on conductivity can be considered\n",
    "by adding a \"thermal modifier\" to the ``cu_litz`` material definition.\n",
    "In this example, conductivity increases by 0.393% per $\\Delta^o$C. The temperature of the objects is set to the default value ($22^o$C)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3f3a740e",
   "metadata": {},
   "outputs": [],
   "source": [
    "cu_resistivity_temp_coefficient = 0.00393\n",
    "cu_litz.conductivity.add_thermal_modifier_free_form(\n",
    "    \"1.0/(1.0+{}*(Temp-20))\".format(cu_resistivity_temp_coefficient)\n",
    ")\n",
    "m3d.modeler.set_objects_temperature([\"Coil\"], ambient_temperature=22)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d52ad02b",
   "metadata": {},
   "source": [
    "### Assign the matrix calculation to the winding\n",
    "\n",
    "The resistance and inductance calculations for the coil are enabled by\n",
    "adding the matrix assignment to the winding."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d8172dc0",
   "metadata": {},
   "outputs": [],
   "source": [
    "m3d.assign_matrix([\"Winding1\"], matrix_name=\"Matrix1\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "47ee6da9",
   "metadata": {},
   "source": [
    "### Create the simulation setup\n",
    "\n",
    "The simulation frequency is 150 kHz. You can query and modify the properties of the simulation setup using ``setup.props``. The \"PercentError\" establishes the minimum allowed change in energy due to the change in mesh size and ensure a small global solution error."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "40057107",
   "metadata": {},
   "outputs": [],
   "source": [
    "setup = m3d.create_setup(name=\"Setup1\")\n",
    "setup.props[\"Frequency\"] = \"150kHz\"\n",
    "setup.props[\"MaximumPasses\"] = 4\n",
    "setup.props[\"PercentError\"] = 0.5\n",
    "setup.props[\"MinimumConvergedPasses\"] = 2"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "00d729b7",
   "metadata": {},
   "source": [
    "### Run the Maxwell 3D analysis\n",
    "\n",
    "The following command runs the 3D finite element analysis in Maxwell."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9a6ae014",
   "metadata": {},
   "outputs": [],
   "source": [
    "m3d.analyze_setup(\"Setup1\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a849daae",
   "metadata": {},
   "source": [
    "## Postprocessing\n",
    "\n",
    "### DC resistance\n",
    "\n",
    "The DC resistance of the coil can be calculated analyticially. The following cell compares the known\n",
    "DC resistance with the simulated coil\n",
    "resistance.\n",
    "\n",
    "The values can be displayed in the AEDT \"Message Manager\". The Ohmic loss in\n",
    "coil is calculated and displayed so we can see the change when Joule\n",
    "heating is considered."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "98a8a77b",
   "metadata": {},
   "outputs": [],
   "source": [
    "report = m3d.post.create_report(expressions=\"Matrix1.R(Winding1,Winding1)\")\n",
    "solution = report.get_solution_data()\n",
    "resistance = solution.get_expression_data(formula=\"magnitude\")[0][0]  # Resistance is the first matrix element.\n",
    "\n",
    "report_loss = m3d.post.create_report(expressions=\"StrandedLossAC\")\n",
    "solution_loss = report_loss.get_solution_data()\n",
    "em_loss = solution_loss.get_expression_data(formula=\"magnitude\")[0][0]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bd489d88",
   "metadata": {},
   "source": [
    "### Analyitic calculation of DC resistance"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8069d4c6",
   "metadata": {},
   "outputs": [],
   "source": [
    "cu_cond = float(cu_litz.conductivity.value)\n",
    "\n",
    "# Average radius of a coil turn = 125 mm\n",
    "avg_coil_radius = (\n",
    "    coil_xsection[1] / 2 + coil_origin[0] / 2\n",
    ") * 0.001  # Convert to meters\n",
    "l_conductor = turns * 2 * avg_coil_radius * 3.1415\n",
    "\n",
    "# R = resistivity * length / area / no_strand\n",
    "r_analytic_DC = (\n",
    "    (1.0 / cu_cond)\n",
    "    * l_conductor\n",
    "    / (3.1415 * (strand_diameter * 0.001 / 2) ** 2)\n",
    "    / no_strands\n",
    ")\n",
    "\n",
    "# Print results in AEDT Message Manager\n",
    "m3d.logger.info(f\"*******Coil analytical DC resistance =  {r_analytic_DC:.2f}Ohm\")\n",
    "m3d.logger.info(\n",
    "    f\"*******Coil resistance at 150kHz BEFORE temperature feedback =  {resistance:.2f}Ohm\"\n",
    ")\n",
    "m3d.logger.info(\n",
    "    f\"*******Ohmic loss in coil BEFORE temperature feedback =  {em_loss / 1000:.2f}W\"\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fef87287",
   "metadata": {},
   "source": [
    "## Create the thermal model\n",
    "\n",
    "The following commands insert an Icepak design into the AEDT project, copies the solid objects from Maxwell 3D, and modifies the region dimensions so they're suitable\n",
    "for thermal convection analysis."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a843235a",
   "metadata": {},
   "outputs": [],
   "source": [
    "ipk = ansys.aedt.core.Icepak(design=icepak_design_name, version=AEDT_VERSION)\n",
    "ipk.copy_solid_bodies_from(m3d, no_pec=False)\n",
    "\n",
    "# Set domain dimensions suitable for natural convection using the diameter of the coil\n",
    "ipk.modeler[\"Region\"].delete()\n",
    "coil_dim = coil.bounding_dimension[0]\n",
    "ipk.modeler.create_region(0, False)\n",
    "ipk.modeler.edit_region_dimensions(\n",
    "    [coil_dim / 2, coil_dim / 2, coil_dim / 2, coil_dim / 2, coil_dim * 2, coil_dim]\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a287cb81",
   "metadata": {},
   "source": [
    "### Map coil losses\n",
    "\n",
    "Map ohmic losses from Maxwell 3D to the Icepak design."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9ad45b33",
   "metadata": {},
   "outputs": [],
   "source": [
    "ipk.assign_em_losses(\n",
    "    design=\"1 Maxwell\",\n",
    "    setup=m3d.setups[0].name,\n",
    "    sweep=\"LastAdaptive\",\n",
    "    assignment=[\"Coil\"],\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a9a5df50",
   "metadata": {},
   "source": [
    "### Define boundary conditions\n",
    "\n",
    "Assign the opening in the Icepak model to allow free airflow."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c23862df",
   "metadata": {},
   "outputs": [],
   "source": [
    "faces = ipk.modeler[\"Region\"].faces\n",
    "face_names = [face.id for face in faces]\n",
    "ipk.assign_free_opening(face_names, boundary_name=\"Opening1\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1569ed11",
   "metadata": {},
   "source": [
    "### Assign monitor\n",
    "\n",
    "Assign a temperature monitor on the coil surface."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6a9b5285",
   "metadata": {},
   "outputs": [],
   "source": [
    "temp_monitor = ipk.assign_point_monitor([70, 0, 0], monitor_name=\"PointMonitor1\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b2ac7ea2",
   "metadata": {},
   "source": [
    "### Set up Icepak solution\n",
    "\n",
    "Icepak solution settings are modified by updating the ``props`` associated with the solution setup."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "29d20697",
   "metadata": {},
   "outputs": [],
   "source": [
    "solution_setup = ipk.create_setup()\n",
    "solution_setup.props[\"Convergence Criteria - Max Iterations\"] = 50\n",
    "solution_setup.props[\"Flow Regime\"] = \"Turbulent\"\n",
    "solution_setup.props[\"Turbulent Model Eqn\"] = \"ZeroEquation\"\n",
    "solution_setup.props[\"Radiation Model\"] = \"Discrete Ordinates Model\"\n",
    "solution_setup.props[\"Include Flow\"] = True\n",
    "solution_setup.props[\"Include Gravity\"] = True\n",
    "solution_setup.props[\"Solution Initialization - Z Velocity\"] = \"0.0005m_per_sec\"\n",
    "solution_setup.props[\"Convergence Criteria - Flow\"] = 0.0005\n",
    "solution_setup.props[\"Flow Iteration Per Radiation Iteration\"] = \"5\""
   ]
  },
  {
   "cell_type": "markdown",
   "id": "26594097",
   "metadata": {},
   "source": [
    "### Add two-way coupling\n",
    "\n",
    "The temperature update from Icepak to Maxwell 3D is activated using the method ``assign_2way_coupling()``. The Ohmic\n",
    "loss in Maxwell will change due to the temperature increase, which in turn will change the results\n",
    "from the Icepak simulation. By default, this iteration occurs twice. However, the named argument\n",
    "``number_of_iterations`` can be passed to the ``assign_2way_coupling`` method to increase the number of iterations.\n",
    "\n",
    "The full electro-thermal analysis is run by calling the ``analyze_setup()`` method."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b6cdd5d8",
   "metadata": {},
   "outputs": [],
   "source": [
    "ipk.assign_2way_coupling()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c002e270",
   "metadata": {},
   "source": [
    "### Run Icepak analysis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cc6381b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "ipk.analyze_setup(name=solution_setup.name)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a09bb712",
   "metadata": {},
   "source": [
    "## Postprocess\n",
    "\n",
    "Plot the temperature on object surfaces."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "76d1d1ae",
   "metadata": {},
   "outputs": [],
   "source": [
    "surface_list = []\n",
    "for name in [\"Coil\", \"Core\"]:\n",
    "    surface_list.extend(ipk.modeler.get_object_faces(name))\n",
    "\n",
    "surf_temperature = ipk.post.create_fieldplot_surface(\n",
    "    surface_list, quantity=\"SurfTemperature\", plot_name=\"Surface Temperature\"\n",
    ")\n",
    "\n",
    "velocity_cutplane = ipk.post.create_fieldplot_cutplane(\n",
    "    assignment=[\"Global:XZ\"], quantity=\"Velocity Vectors\", plot_name=\"Velocity Vectors\"\n",
    ")\n",
    "\n",
    "surf_temperature.export_image()\n",
    "velocity_cutplane.export_image(orientation=\"right\")\n",
    "\n",
    "report_temp = ipk.post.create_report(\n",
    "    expressions=\"PointMonitor1.Temperature\", primary_sweep_variable=\"X\"\n",
    ")\n",
    "solution_temp = report_temp.get_solution_data()\n",
    "temp = solution_temp.get_expression_data(formula=\"magnitude\")[1][0]\n",
    "m3d.logger.info(\"*******Coil temperature =  {:.2f}deg C\".format(temp))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3731b239",
   "metadata": {},
   "source": [
    "### Get updated resistance from Maxwell 3D\n",
    "\n",
    "The temperature of the coil increases, and consequently the coil resistance increases."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b342fbd1",
   "metadata": {},
   "outputs": [],
   "source": [
    "report_new = m3d.post.create_report(expressions=\"Matrix1.R(Winding1,Winding1)\")\n",
    "solution_new = report_new.get_solution_data()\n",
    "resistance_new = solution_new.get_expression_data(formula=\"magnitude\")[1][0]\n",
    "resistance_increase = (resistance_new - resistance) / resistance * 100\n",
    "\n",
    "report_loss_new = m3d.post.create_report(expressions=\"StrandedLossAC\")\n",
    "solution_loss_new = report_loss_new.get_solution_data()\n",
    "em_loss_new = solution_loss_new.get_expression_data(formula=\"magnitude\")[1][0]\n",
    "\n",
    "m3d.logger.info(\n",
    "    \"*******Coil resistance at 150kHz AFTER temperature feedback =  {:.2f}Ohm\".format(\n",
    "        resistance_new\n",
    "    )\n",
    ")\n",
    "m3d.logger.info(\n",
    "    \"*******Coil resistance increased by {:.2f}%\".format(resistance_increase)\n",
    ")\n",
    "m3d.logger.info(\n",
    "    \"*******Ohmic loss in coil AFTER temperature feedback =  {:.2f}W\".format(\n",
    "        em_loss_new / 1000\n",
    "    )\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d4ea5bff",
   "metadata": {},
   "source": [
    "### Save the project"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f10259fa",
   "metadata": {},
   "outputs": [],
   "source": [
    "ipk.save_project()\n",
    "ipk.release_desktop()\n",
    "time.sleep(3)  # Allow AEDT to shut down before cleaning the temporary project folder."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4e6d1e16",
   "metadata": {},
   "source": [
    "### Clean up\n",
    "\n",
    "All project files are saved in the folder ``temp_folder.name``.\n",
    "If you've run this example as a Jupyter notebook, you\n",
    "can retrieve those project files. The following cell\n",
    "removes all temporary files, including the project folder."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0b5dc222",
   "metadata": {},
   "outputs": [],
   "source": [
    "temp_folder.cleanup()"
   ]
  }
 ],
 "metadata": {
  "jupytext": {
   "cell_metadata_filter": "-all",
   "main_language": "python",
   "notebook_metadata_filter": "-all"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
