
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Q3D Dynamic link to Twin Builder for the DC-Link bus bars of a drive inverter &#8212; PyAEDT Examples</title>

  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css\ansys_sphinx_theme.css?v=d2ac875c" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" type="text/css" href="https://www.nerdfonts.com/assets/css/webfont.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=9233c59b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/highlight.css?v=500661c4" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>
 
<link href="../../_static/css/breadcrumbs.css" rel="stylesheet" />

    <script src="../../_static/documentation_options.js?v=e7fb764e"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=49e1bf35"></script>
    <script src="../../_static/js\table.js?v=b64f5182"></script>
    <script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/electrothermal/three_phase_inverter';</script>
    <link rel="icon" href="../../_static/ansys-favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Pre-processing and post-processing" href="../aedt_general/index.html" />
    <link rel="prev" title="Multi physics HFSS-Icepak microwave oven simulation" href="../high_frequency/multiphysics/microwave_oven.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <link rel="canonical" href="https://examples.aedt.docs.pyansys.com/version/stable/examples/electrothermal/three_phase_inverter.html" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container"><!-- Debugging: html_theme_options =  -->

  <!-- If there is no MeiliSearch enabled, use the PyData search -->
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

   
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="https://www.ansys.com/">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/ansys_logo_transparent_black.png" class="logo__image only-light" alt="PyAEDT Examples - Home"/>
    <script>document.write(`<img src="../../_static/ansys_logo_transparent_white.png" class="logo__image only-dark" alt="PyAEDT Examples - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyaedt-examples" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyaedt-examples/discussions" title="Support" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comment fa-fw fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Support</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
    

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyaedt-examples" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyaedt-examples/discussions" title="Support" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comment fa-fw fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Support</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../aedt/index.html">Examples by AEDT application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../high_frequency/index.html">High frequency</a></li>
<li class="toctree-l1"><a class="reference internal" href="../low_frequency/index.html">Low frequency</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Electrothermal</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="components_csv.html">PCB component definition from CSV file and model image exports</a></li>
<li class="toctree-l2"><a class="reference internal" href="ecad_import.html">Import of a PCB and its components via IDF and EDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="graphic_card.html">Graphic card thermal analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="coaxial_hfss_icepak.html">Coaxial</a></li>
<li class="toctree-l2"><a class="reference internal" href="sherlock.html">Setup from Sherlock inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="icepak_circuit_hfss_coupling.html">Circuit-HFSS-Icepak coupling workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="electrothermal.html">Electrothermal analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../low_frequency/multiphysics/maxwell_icepak.html">Maxwell 3D-Icepak electrothermal analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../high_frequency/multiphysics/microwave_oven.html">Multi physics HFSS-Icepak microwave oven simulation</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Q3D Dynamic link to Twin Builder for the DC-Link bus bars of a drive inverter</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../aedt_general/index.html">Pre-processing and post-processing</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">
<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
         
    <li class="breadcrumb-item breadcrumb-home">
      <a href="https://docs.pyansys.com/" class="nav-link">PyAnsys</a>
    </li>
       
    <li class="breadcrumb-item">
      <a href="https://aedt.docs.pyansys.com/" class="nav-link">PyAEDT</a>
    </li>
     
    <li class="breadcrumb-item">
      <a
        href="../../index.html"
        class="nav-link"
        aria-label="Home"
      >
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
     
    <li class="breadcrumb-item">
      <a href="../index.html" class="nav-link">Examples</a>
    </li>
     
    <li class="breadcrumb-item">
      <a href="index.html" class="nav-link">Electrothermal</a>
    </li>
      
    <li class="breadcrumb-item active" aria-current="page">Q3D Dynamic link to Twin Builder for the DC-Link bus bars of a drive inverter</li>
    
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="admonition-download-this-example admonition">
<p class="admonition-title">Download this example</p>
<p>Download this example as a <a class="reference external" href="https://examples.aedt.docs.pyansys.com/version/dev/examples/electrothermal/three_phase_inverter.ipynb">Jupyter Notebook</a>
or as a <a class="reference external" href="https://examples.aedt.docs.pyansys.com/version/dev/examples/electrothermal/three_phase_inverter.py">Python script</a>.</p>
</div>
<hr class="docutils" />
<section id="Q3D-Dynamic-link-to-Twin-Builder-for-the-DC-Link-bus-bars-of-a-drive-inverter">
<h1>Q3D Dynamic link to Twin Builder for the DC-Link bus bars of a drive inverter<a class="headerlink" href="#Q3D-Dynamic-link-to-Twin-Builder-for-the-DC-Link-bus-bars-of-a-drive-inverter" title="Link to this heading">#</a></h1>
<p>The example based in the DC-Link bus bars of a three-phase inverter covers the electro-thermal workflow with the Harmonic loss calculation in Q3D Extractor and temperature and thermal anlaysis in Icepak.</p>
<p>Keywords: <strong>Twinbuilder</strong>, <strong>Q3D</strong>, <strong>Icepak</strong>, <strong>Electrothermal</strong>.</p>
<section id="Perform-imports-and-define-constants">
<h2>Perform imports and define constants<a class="headerlink" href="#Perform-imports-and-define-constants" title="Link to this heading">#</a></h2>
<p>Perform required imports.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">ansys.aedt.core</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ansys.aedt.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_pyaedt_app</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ansys.aedt.core.examples.downloads</span><span class="w"> </span><span class="kn">import</span> <span class="n">download_file</span>
</pre></div>
</div>
</div>
</section>
<section id="Define-constants">
<h2>Define constants<a class="headerlink" href="#Define-constants" title="Link to this heading">#</a></h2>
<p>Constants help ensure consistency and avoid repetition throughout the example.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">AEDT_VERSION</span> <span class="o">=</span> <span class="s2">&quot;2025.2&quot;</span>
<span class="n">NUM_CORES</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">NG_MODE</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Open AEDT UI when it is launched.</span>
<span class="n">TB_DESIGN_NAME</span> <span class="o">=</span> <span class="s2">&quot;3ph_circuit&quot;</span>
<span class="n">Q3D_DESIGN_NAME</span> <span class="o">=</span> <span class="s2">&quot;q3d_3ph&quot;</span>
<span class="n">ICEPAK_DESIGN_NAME</span> <span class="o">=</span> <span class="s2">&quot;Icepak_1&quot;</span>
</pre></div>
</div>
</div>
</section>
<section id="Create-temporary-directory">
<h2>Create temporary directory<a class="headerlink" href="#Create-temporary-directory" title="Link to this heading">#</a></h2>
<p>Create a temporary working directory. The name of the working folder is stored in <code class="docutils literal notranslate"><span class="pre">temp_folder.name</span></code>.</p>
<blockquote>
<div><p><strong>Note:</strong> The final cell in the notebook cleans up the temporary folder. If you want to retrieve the AEDT project and data, do so before executing the final cell in the notebook.</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_folder</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.ansys&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Download-AEDT-file">
<h2>Download AEDT file<a class="headerlink" href="#Download-AEDT-file" title="Link to this heading">#</a></h2>
<p>Set the local temporary folder to export the AEDT file to.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">project_path</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span>
    <span class="n">source</span><span class="o">=</span><span class="s2">&quot;q3d_dynamic_link&quot;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;busbar_q3d_tb.aedt&quot;</span><span class="p">,</span>
    <span class="n">local_path</span><span class="o">=</span><span class="n">temp_folder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Launch-Maxwell-AEDT">
<h2>Launch Maxwell AEDT<a class="headerlink" href="#Launch-Maxwell-AEDT" title="Link to this heading">#</a></h2>
<p>Create an instance of the <code class="docutils literal notranslate"><span class="pre">Twinbuilder</span></code> class. The Ansys Electronics Desktop will be launched with the active Twinbuilder design. The <code class="docutils literal notranslate"><span class="pre">tb</span></code> object is subsequently used to create and simulate the model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tb</span> <span class="o">=</span> <span class="n">ansys</span><span class="o">.</span><span class="n">aedt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">TwinBuilder</span><span class="p">(</span>
    <span class="n">project</span><span class="o">=</span><span class="n">project_path</span><span class="p">,</span>
    <span class="n">design</span><span class="o">=</span><span class="n">TB_DESIGN_NAME</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="n">AEDT_VERSION</span><span class="p">,</span>
    <span class="n">non_graphical</span><span class="o">=</span><span class="n">NG_MODE</span><span class="p">,</span>
    <span class="n">new_desktop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Parsing C:\Users\ansys\AppData\Local\Temp\tmp61xontsz.ansys\q3d_dynamic_link\busbar_q3d_tb.aedt.
PyAEDT INFO: Python version 3.10.11 (tags/v3.10.11:7d4cc5a, Apr  5 2023, 00:38:17) [MSC v.1929 64 bit (AMD64)].
PyAEDT INFO: PyAEDT version 0.25.dev0.
PyAEDT INFO: Initializing new Desktop session.
PyAEDT INFO: Log on console is enabled.
PyAEDT INFO: Log on file C:\Users\ansys\AppData\Local\Temp\pyaedt_ansys_f4610992-5af7-47bb-b825-e46ae6881bee.log is enabled.
PyAEDT INFO: Log on AEDT is disabled.
PyAEDT INFO: Starting new AEDT gRPC session.
PyAEDT INFO: AEDT installation Path C:\Program Files\ANSYS Inc\v252\AnsysEM
PyAEDT INFO: Client application successfully started.
PyAEDT INFO: New AEDT gRPC session session started on port 50051.
PyAEDT INFO: 2025.2 version started with process ID 8452.
PyAEDT WARNING: Service Pack is not detected. PyAEDT is currently connecting in Insecure Mode.
PyAEDT INFO: File C:\Users\ansys\AppData\Local\Temp\tmp61xontsz.ansys\q3d_dynamic_link\busbar_q3d_tb.aedt correctly loaded. Elapsed time: 0m 11sec
PyAEDT WARNING: Please download and install latest Service Pack to use connect to AEDT in Secure Mode.
PyAEDT INFO: Debug logger is disabled. PyAEDT methods will not be logged.
PyAEDT INFO: Project busbar_q3d_tb has been opened.
PyAEDT INFO: Active Design set to 25650;3ph_circuit
PyAEDT INFO: Aedt Objects correctly read
</pre></div></div>
</div>
</section>
<section id="Add-Q3D-component-to-Twinbuilder-schematic">
<h2>Add Q3D component to Twinbuilder schematic<a class="headerlink" href="#Add-Q3D-component-to-Twinbuilder-schematic" title="Link to this heading">#</a></h2>
<p>Add a Q3D dynamic link to the Twinbuilder schematic. The Q3D State Space component creates a state-space model that is valid over a range of frequencies. The component uses RLGC model extracted from the Q3D design to create a frequency sweep.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">add_q3d_dynamic_component</span><span class="p">(</span>
    <span class="n">source_project</span><span class="o">=</span><span class="n">tb</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span> <span class="n">source_design_name</span><span class="o">=</span><span class="n">Q3D_DESIGN_NAME</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="s2">&quot;Setup1&quot;</span><span class="p">,</span> <span class="n">sweep</span><span class="o">=</span><span class="s2">&quot;Sweep1&quot;</span><span class="p">,</span> <span class="n">coupling_matrix_name</span><span class="o">=</span><span class="s2">&quot;Original&quot;</span><span class="p">,</span> <span class="n">state_space_dynamic_link_type</span><span class="o">=</span><span class="s2">&quot;RLGC&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Python version 3.10.11 (tags/v3.10.11:7d4cc5a, Apr  5 2023, 00:38:17) [MSC v.1929 64 bit (AMD64)].
PyAEDT INFO: PyAEDT version 0.25.dev0.
PyAEDT INFO: Returning found Desktop session with PID 8452!
PyAEDT INFO: Project busbar_q3d_tb set to active.
PyAEDT INFO: Active Design set to q3d_3ph
PyAEDT INFO: Aedt Objects correctly read
PyAEDT INFO: ModelerCircuit class has been initialized! Elapsed time: 0m 0sec
PyAEDT INFO: ModelerTwinBuilder class has been initialized!
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tb</span><span class="o">.</span><span class="n">set_active_design</span><span class="p">(</span><span class="n">TB_DESIGN_NAME</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Python version 3.10.11 (tags/v3.10.11:7d4cc5a, Apr  5 2023, 00:38:17) [MSC v.1929 64 bit (AMD64)].
PyAEDT INFO: PyAEDT version 0.25.dev0.
PyAEDT INFO: Returning found Desktop session with PID 8452!
PyAEDT INFO: Project busbar_q3d_tb set to active.
PyAEDT INFO: Active Design set to 25650;3ph_circuit
PyAEDT INFO: Aedt Objects correctly read
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="Place-component-on-schematic">
<h2>Place component on schematic<a class="headerlink" href="#Place-component-on-schematic" title="Link to this heading">#</a></h2>
<p>Place the dynamic component on the schematic at the desired location (expressed in mm). Add page ports and ammeters to each terminal of the component.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_position</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">y_position</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">comp</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_position</span><span class="p">,</span> <span class="n">y_position</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ammeter_x_factor</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">previous_value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">reset</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="n">pin</span> <span class="ow">in</span> <span class="n">comp</span><span class="o">.</span><span class="n">pins</span><span class="p">:</span>
    <span class="n">current_value</span> <span class="o">=</span> <span class="n">pin</span><span class="o">.</span><span class="n">angle</span>
    <span class="k">if</span> <span class="n">current_value</span> <span class="o">!=</span> <span class="n">previous_value</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">reset</span><span class="p">:</span>
            <span class="n">ammeter_x_factor</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">reset</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">angle_page_port</span> <span class="o">=</span> <span class="mi">180</span>
        <span class="n">angle_ammeter</span> <span class="o">=</span> <span class="mi">270</span>
        <span class="n">ammeter_x_factor</span> <span class="o">+=</span> <span class="mf">0.015</span>
        <span class="n">label_position</span> <span class="o">=</span> <span class="s2">&quot;Right&quot;</span>
        <span class="n">ammeter_y_factor</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.002</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">angle_page_port</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">angle_ammeter</span> <span class="o">=</span> <span class="mi">90</span>
        <span class="n">ammeter_x_factor</span> <span class="o">-=</span> <span class="mf">0.015</span>
        <span class="n">label_position</span> <span class="o">=</span> <span class="s2">&quot;Left&quot;</span>
        <span class="n">ammeter_y_factor</span> <span class="o">=</span> <span class="mf">0.002</span>

    <span class="n">prefix_1</span> <span class="o">=</span> <span class="s2">&quot;dc_plus&quot;</span>
    <span class="n">prefix_2</span> <span class="o">=</span> <span class="s2">&quot;dc_minus&quot;</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix_1</span> <span class="k">if</span> <span class="n">pin</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix_1</span><span class="p">)</span> <span class="k">else</span> <span class="n">prefix_2</span>
    <span class="n">terminal</span> <span class="o">=</span> <span class="n">pin</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
    <span class="n">ammeter</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">create_component</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">terminal</span><span class="p">,</span>
        <span class="n">component_library</span><span class="o">=</span><span class="s2">&quot;Basic Elements</span><span class="se">\\</span><span class="s2">Measurement</span><span class="se">\\</span><span class="s2">Electrical&quot;</span><span class="p">,</span>
        <span class="n">component_name</span><span class="o">=</span><span class="s2">&quot;AM&quot;</span><span class="p">,</span>
        <span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">pin</span><span class="o">.</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ammeter_x_factor</span><span class="p">,</span> <span class="n">pin</span><span class="o">.</span><span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ammeter_y_factor</span><span class="p">],</span>
        <span class="n">angle</span><span class="o">=</span><span class="n">angle_ammeter</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">comp_page_port</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">create_page_port</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">terminal</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">ammeter</span><span class="o">.</span><span class="n">pins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="n">label_position</span><span class="o">=</span><span class="n">label_position</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle_page_port</span><span class="p">)</span>
    <span class="n">tb</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">schematic</span><span class="o">.</span><span class="n">create_wire</span><span class="p">([</span><span class="n">ammeter</span><span class="o">.</span><span class="n">pins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="n">pin</span><span class="o">.</span><span class="n">location</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: ModelerCircuit class has been initialized! Elapsed time: 0m 0sec
PyAEDT INFO: ModelerTwinBuilder class has been initialized!
</pre></div></div>
</div>
</section>
<section id="Solve-transient-setup">
<h2>Solve transient setup<a class="headerlink" href="#Solve-transient-setup" title="Link to this heading">#</a></h2>
<p>Solve the transient setup.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tb</span><span class="o">.</span><span class="n">analyze_setup</span><span class="p">(</span><span class="s2">&quot;TR&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Solving design setup TR
PyAEDT INFO: Design setup TR solved correctly in 0.0h 6.0m 31.0s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="Twinbuilder-Post-processing-:-Time-domain">
<h2>Twinbuilder Post-processing : Time domain<a class="headerlink" href="#Twinbuilder-Post-processing-:-Time-domain" title="Link to this heading">#</a></h2>
<p>Create reports for capacitor currents, load currents, DC current and voltage.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cap_currents</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ca.I&quot;</span><span class="p">,</span> <span class="s2">&quot;Cb.I&quot;</span><span class="p">,</span> <span class="s2">&quot;Cc.I&quot;</span><span class="p">],</span>
    <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span>
    <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;Capacitor Currents&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Post class has been initialized! Elapsed time: 0m 0sec
PyAEDT WARNING: No report category provided. Automatically identified Standard
</pre></div></div>
</div>
<p>add markers at 10ms and 20ms</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cap_currents</span><span class="o">.</span><span class="n">add_cartesian_x_marker</span><span class="p">(</span><span class="s2">&quot;10ms&quot;</span><span class="p">)</span>
<span class="n">cap_currents</span><span class="o">.</span><span class="n">add_cartesian_x_marker</span><span class="p">(</span><span class="s2">&quot;20ms&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;MX_K6KW10&#39;
</pre></div></div>
</div>
<p>Plot only between 10ms and 20ms</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cap_currents_range</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ca.I&quot;</span><span class="p">,</span> <span class="s2">&quot;Cb.I&quot;</span><span class="p">,</span> <span class="s2">&quot;Cc.I&quot;</span><span class="p">],</span>
    <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span>
    <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;Capacitor Currents - [10ms-20ms]&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">cap_currents_range</span><span class="o">.</span><span class="n">edit_x_axis_scaling</span><span class="p">(</span><span class="n">min_scale</span><span class="o">=</span><span class="s2">&quot;10ms&quot;</span><span class="p">,</span> <span class="n">max_scale</span><span class="o">=</span><span class="s2">&quot;20ms&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT WARNING: No report category provided. Automatically identified Standard
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i_load</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;L4.I&quot;</span><span class="p">,</span> <span class="s2">&quot;L5.I&quot;</span><span class="p">,</span> <span class="s2">&quot;L6.I&quot;</span><span class="p">],</span>
    <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span>
    <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;Load Currents&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">i_dc</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dc_ground.I&quot;</span><span class="p">],</span>
    <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span>
    <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;Idc&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">v_dc</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Vdc_minus.V&quot;</span><span class="p">,</span> <span class="s2">&quot;Vdc_plus.V&quot;</span><span class="p">],</span>
    <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span>
    <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;Vdc&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT WARNING: No report category provided. Automatically identified Standard
PyAEDT WARNING: No report category provided. Automatically identified Standard
PyAEDT WARNING: No report category provided. Automatically identified Standard
</pre></div></div>
</div>
</section>
<section id="Twinbuilder-Post-processing-:-Frequency-domain">
<h2>Twinbuilder Post-processing : Frequency domain<a class="headerlink" href="#Twinbuilder-Post-processing-:-Frequency-domain" title="Link to this heading">#</a></h2>
<p>Create spectral reports for all sources in the whole spectral domain. Get the list of sources from the Q3D design. Then, create a spectral report in Twinbuilder for the real and imaginary parts of the source currents.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q3d</span> <span class="o">=</span> <span class="n">get_pyaedt_app</span><span class="p">(</span><span class="n">tb</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span> <span class="n">Q3D_DESIGN_NAME</span><span class="p">)</span>
<span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="n">source</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">q3d</span><span class="o">.</span><span class="n">boundaries_by_type</span><span class="p">[</span><span class="s2">&quot;Source&quot;</span><span class="p">]]</span>
<span class="n">tb</span> <span class="o">=</span> <span class="n">get_pyaedt_app</span><span class="p">(</span><span class="n">tb</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span> <span class="n">TB_DESIGN_NAME</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Python version 3.10.11 (tags/v3.10.11:7d4cc5a, Apr  5 2023, 00:38:17) [MSC v.1929 64 bit (AMD64)].
PyAEDT INFO: PyAEDT version 0.25.dev0.
PyAEDT INFO: Returning found Desktop session with PID 8452!
PyAEDT INFO: Project busbar_q3d_tb set to active.
PyAEDT INFO: Active Design set to q3d_3ph
PyAEDT INFO: Aedt Objects correctly read
PyAEDT INFO: Python version 3.10.11 (tags/v3.10.11:7d4cc5a, Apr  5 2023, 00:38:17) [MSC v.1929 64 bit (AMD64)].
PyAEDT INFO: PyAEDT version 0.25.dev0.
PyAEDT INFO: Returning found Desktop session with PID 8452!
PyAEDT INFO: Project busbar_q3d_tb set to active.
PyAEDT INFO: Active Design set to 25650;3ph_circuit
PyAEDT INFO: Aedt Objects correctly read
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expressions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
    <span class="n">expressions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;re(</span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">.I)&quot;</span><span class="p">)</span>
    <span class="n">expressions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;im(</span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">.I)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Create the spectral report for real and imaginary parts of source currents</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_report</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">reports_by_category</span><span class="o">.</span><span class="n">spectral</span><span class="p">(</span><span class="n">expressions</span><span class="p">,</span> <span class="s2">&quot;TR&quot;</span><span class="p">)</span>
<span class="n">new_report</span><span class="o">.</span><span class="n">algorithm</span> <span class="o">=</span> <span class="s2">&quot;FFT&quot;</span>
<span class="n">new_report</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="s2">&quot;Rectangular&quot;</span>
<span class="n">new_report</span><span class="o">.</span><span class="n">max_frequency</span> <span class="o">=</span> <span class="s2">&quot;100kHz&quot;</span>
<span class="n">new_report</span><span class="o">.</span><span class="n">time_start</span> <span class="o">=</span> <span class="s2">&quot;20ms&quot;</span>
<span class="n">new_report</span><span class="o">.</span><span class="n">time_stop</span> <span class="o">=</span> <span class="s2">&quot;30ms&quot;</span>
<span class="n">new_report</span><span class="o">.</span><span class="n">variations</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Spectrum&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">}</span>
<span class="n">new_report</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;Q3D_sources&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Post class has been initialized! Elapsed time: 0m 1sec
PyAEDT WARNING: No report category provided. Automatically identified Standard
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<p>Export report in a CSV file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">report_path</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">export_report_to_csv</span><span class="p">(</span><span class="n">temp_folder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;Q3D_sources&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Filter-data">
<h2>Filter data<a class="headerlink" href="#Filter-data" title="Link to this heading">#</a></h2>
<p>Filter out rows where at least one between real and imaginary part of any source current is below a defined threshold.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q3d_sources_unfiltered</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.01</span>
</pre></div>
</div>
</div>
<p>Identify rows below threshold If at least one between real and imaginary are below threshold, mark for deletion the entire row</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">q3d_sources_unfiltered</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;re(</span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">.I) [A]&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">q3d_sources_unfiltered</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;im(</span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">.I) [A]&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Drop those rows</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q3d_sources_filtered</span> <span class="o">=</span> <span class="n">q3d_sources_unfiltered</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Save filtered data back to a new CSV file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q3d_sources_filtered_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tb</span><span class="o">.</span><span class="n">working_directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;Q3D_sources_filtered.csv&quot;</span>
<span class="n">q3d_sources_filtered</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">q3d_sources_filtered_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Save real and imaginary part in separate tab-separated files Each .tab file will contain two columns: frequency and the corresponding part (real or imaginary) After exporting, import each .tab file as a dataset 1D in Q3D</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq_column</span> <span class="o">=</span> <span class="n">q3d_sources_filtered</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">q3d_sources_filtered</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="c1"># Save the DataFrame as a tab-separated file</span>
    <span class="n">new_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tb</span><span class="o">.</span><span class="n">working_directory</span><span class="p">)</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">.tab&quot;</span>
    <span class="n">q3d_sources_filtered</span><span class="p">[[</span><span class="n">freq_column</span><span class="p">,</span> <span class="n">col</span><span class="p">]]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">new_file_name</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Determine dataset name and import it</span>
    <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;re&quot;</span><span class="p">:</span>
        <span class="n">dataset_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;re_</span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">elif</span> <span class="n">col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;im&quot;</span><span class="p">:</span>
        <span class="n">dataset_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;im_</span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">q3d</span><span class="o">.</span><span class="n">import_dataset1d</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">new_file_name</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="n">dataset_name</span><span class="p">,</span> <span class="n">is_project_dataset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Parsing C:\Users\ansys\AppData\Local\Temp\tmp61xontsz.ansys\q3d_dynamic_link\busbar_q3d_tb.aedt.
PyAEDT INFO: File C:\Users\ansys\AppData\Local\Temp\tmp61xontsz.ansys\q3d_dynamic_link\busbar_q3d_tb.aedt correctly loaded. Elapsed time: 0m 0sec
PyAEDT INFO: aedt file load time 0.4302847385406494
PyAEDT INFO: Dataset re_cap_a_minus doesn&#39;t exist.
PyAEDT INFO: Dataset re_cap_a_minus created successfully.
PyAEDT INFO: Dataset im_cap_a_minus doesn&#39;t exist.
PyAEDT INFO: Dataset im_cap_a_minus created successfully.
PyAEDT INFO: Dataset re_cap_a_plus doesn&#39;t exist.
PyAEDT INFO: Dataset re_cap_a_plus created successfully.
PyAEDT INFO: Dataset im_cap_a_plus doesn&#39;t exist.
PyAEDT INFO: Dataset im_cap_a_plus created successfully.
PyAEDT INFO: Dataset re_module_a_minus doesn&#39;t exist.
PyAEDT INFO: Dataset re_module_a_minus created successfully.
PyAEDT INFO: Dataset im_module_a_minus doesn&#39;t exist.
PyAEDT INFO: Dataset im_module_a_minus created successfully.
PyAEDT INFO: Dataset re_module_a_plus doesn&#39;t exist.
PyAEDT INFO: Dataset re_module_a_plus created successfully.
PyAEDT INFO: Dataset im_module_a_plus doesn&#39;t exist.
PyAEDT INFO: Dataset im_module_a_plus created successfully.
PyAEDT INFO: Dataset re_cap_b_minus doesn&#39;t exist.
PyAEDT INFO: Dataset re_cap_b_minus created successfully.
PyAEDT INFO: Dataset im_cap_b_minus doesn&#39;t exist.
PyAEDT INFO: Dataset im_cap_b_minus created successfully.
PyAEDT INFO: Dataset re_cap_b_plus doesn&#39;t exist.
PyAEDT INFO: Dataset re_cap_b_plus created successfully.
PyAEDT INFO: Dataset im_cap_b_plus doesn&#39;t exist.
PyAEDT INFO: Dataset im_cap_b_plus created successfully.
PyAEDT INFO: Dataset re_module_b_minus doesn&#39;t exist.
PyAEDT INFO: Dataset re_module_b_minus created successfully.
PyAEDT INFO: Dataset im_module_b_minus doesn&#39;t exist.
PyAEDT INFO: Dataset im_module_b_minus created successfully.
PyAEDT INFO: Dataset re_module_b_plus doesn&#39;t exist.
PyAEDT INFO: Dataset re_module_b_plus created successfully.
PyAEDT INFO: Dataset im_module_b_plus doesn&#39;t exist.
PyAEDT INFO: Dataset im_module_b_plus created successfully.
PyAEDT INFO: Dataset re_cap_c_minus doesn&#39;t exist.
PyAEDT INFO: Dataset re_cap_c_minus created successfully.
PyAEDT INFO: Dataset im_cap_c_minus doesn&#39;t exist.
PyAEDT INFO: Dataset im_cap_c_minus created successfully.
PyAEDT INFO: Dataset re_cap_c_plus doesn&#39;t exist.
PyAEDT INFO: Dataset re_cap_c_plus created successfully.
PyAEDT INFO: Dataset im_cap_c_plus doesn&#39;t exist.
PyAEDT INFO: Dataset im_cap_c_plus created successfully.
PyAEDT INFO: Dataset re_module_c_minus doesn&#39;t exist.
PyAEDT INFO: Dataset re_module_c_minus created successfully.
PyAEDT INFO: Dataset im_module_c_minus doesn&#39;t exist.
PyAEDT INFO: Dataset im_module_c_minus created successfully.
PyAEDT INFO: Dataset re_module_c_plus doesn&#39;t exist.
PyAEDT INFO: Dataset re_module_c_plus created successfully.
PyAEDT INFO: Dataset im_module_c_plus doesn&#39;t exist.
PyAEDT INFO: Dataset im_module_c_plus created successfully.
</pre></div></div>
</div>
</section>
<section id="Q3D:-Harmonic-loss-setup">
<h2>Q3D: Harmonic loss setup<a class="headerlink" href="#Q3D:-Harmonic-loss-setup" title="Link to this heading">#</a></h2>
<p>Specify real and imaginary currents for each source to compute harmonic loss.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">harmonic_loss</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
    <span class="n">re_dataset_name</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">q3d</span><span class="o">.</span><span class="n">design_datasets</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">if</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">d</span> <span class="ow">and</span> <span class="s2">&quot;re&quot;</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
    <span class="n">im_dataset_name</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">q3d</span><span class="o">.</span><span class="n">design_datasets</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">if</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">d</span> <span class="ow">and</span> <span class="s2">&quot;im&quot;</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
    <span class="n">harmonic_loss</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">re_dataset_name</span><span class="p">,</span> <span class="n">im_dataset_name</span><span class="p">)</span>
<span class="n">q3d</span><span class="o">.</span><span class="n">edit_sources</span><span class="p">(</span><span class="n">harmonic_loss</span><span class="o">=</span><span class="n">harmonic_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="Q3D-Post-processing">
<h2>Q3D Post-processing<a class="headerlink" href="#Q3D-Post-processing" title="Link to this heading">#</a></h2>
<p>Plot the harmonic loss density on the surface of the objects</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">q3d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_fieldplot_surface</span><span class="p">([</span><span class="s2">&quot;dc_terminal&quot;</span><span class="p">,</span> <span class="s2">&quot;dc_terminal_1_2&quot;</span><span class="p">],</span> <span class="s2">&quot;Harmonic_Loss_Density&quot;</span><span class="p">,</span> <span class="n">intrinsics</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Freq&quot;</span><span class="p">:</span> <span class="s2">&quot;0.5GHz&quot;</span><span class="p">,</span> <span class="s2">&quot;Phase&quot;</span><span class="p">:</span> <span class="s2">&quot;0deg&quot;</span><span class="p">})</span>
<span class="n">q3d</span><span class="o">.</span><span class="n">save_project</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: PostProcessor class has been initialized! Elapsed time: 0m 2sec
PyAEDT INFO: Post class has been initialized! Elapsed time: 0m 2sec
PyAEDT INFO: Modeler class has been initialized! Elapsed time: 0m 1sec
PyAEDT INFO: Active Design set to q3d_3ph
PyAEDT INFO: Parsing design objects. This operation can take time
PyAEDT INFO: Refreshing bodies from Object Info
PyAEDT INFO: Bodies Info Refreshed Elapsed time: 0m 0sec
PyAEDT INFO: 3D Modeler objects parsed. Elapsed time: 0m 0sec
PyAEDT INFO: Project busbar_q3d_tb Saved correctly
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">folder_settings</span>
<span class="n">fs</span><span class="o">.</span><span class="n">scale_settings</span><span class="o">.</span><span class="n">scale_type</span> <span class="o">=</span> <span class="s2">&quot;MinMax&quot;</span>
<span class="n">fs</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="n">fs</span><span class="o">.</span><span class="n">scale_settings</span><span class="o">.</span><span class="n">scale_settings</span><span class="o">.</span><span class="n">max_value</span> <span class="o">=</span> <span class="mi">1040000</span>
<span class="n">fs</span><span class="o">.</span><span class="n">scale_settings</span><span class="o">.</span><span class="n">scale_settings</span><span class="o">.</span><span class="n">min_value</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">fs</span><span class="o">.</span><span class="n">scale_settings</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">fs</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Create-Icepak-Design">
<h2>Create Icepak Design<a class="headerlink" href="#Create-Icepak-Design" title="Link to this heading">#</a></h2>
<p>Create an Icepak to run a thermal simulation</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipk</span> <span class="o">=</span> <span class="n">ansys</span><span class="o">.</span><span class="n">aedt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Icepak</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="n">AEDT_VERSION</span><span class="p">,</span> <span class="n">design</span><span class="o">=</span><span class="n">ICEPAK_DESIGN_NAME</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Python version 3.10.11 (tags/v3.10.11:7d4cc5a, Apr  5 2023, 00:38:17) [MSC v.1929 64 bit (AMD64)].
PyAEDT INFO: PyAEDT version 0.25.dev0.
PyAEDT INFO: Returning found Desktop session with PID 8452!
PyAEDT INFO: No project is defined. Project busbar_q3d_tb exists and has been read.
PyAEDT INFO: Added design &#39;Icepak_1&#39; of type Icepak.
PyAEDT INFO: Aedt Objects correctly read
</pre></div></div>
</div>
</section>
<section id="Copy-bodies-from-Q3D-to-Icepak">
<h2>Copy bodies from Q3D to Icepak<a class="headerlink" href="#Copy-bodies-from-Q3D-to-Icepak" title="Link to this heading">#</a></h2>
<p>Copy solid bodies from Q3D design to Icepak design</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">copy_bodies_from_q3d</span> <span class="o">=</span> <span class="n">q3d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_objects_by_material</span><span class="p">(</span><span class="s2">&quot;copper&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">q3d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">sheet_objects</span>
<span class="n">ipk</span><span class="o">.</span><span class="n">copy_solid_bodies_from</span><span class="p">(</span><span class="n">q3d</span><span class="p">,</span> <span class="n">assignment</span><span class="o">=</span><span class="n">copy_bodies_from_q3d</span><span class="p">,</span> <span class="n">include_sheets</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Modeler class has been initialized! Elapsed time: 0m 0sec
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="Change-region-padding-and-create-subregion">
<h2>Change region padding and create subregion<a class="headerlink" href="#Change-region-padding-and-create-subregion" title="Link to this heading">#</a></h2>
<p>Change region padding and create subregion to enclose the objects imported from Q3D</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipk</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">change_region_padding</span><span class="p">(</span>
    <span class="n">padding_data</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;200mm&quot;</span><span class="p">,</span> <span class="s2">&quot;200mm&quot;</span><span class="p">],</span> <span class="n">padding_type</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Percentage Offset&quot;</span><span class="p">,</span> <span class="s2">&quot;Percentage Offset&quot;</span><span class="p">,</span> <span class="s2">&quot;Percentage Offset&quot;</span><span class="p">,</span> <span class="s2">&quot;Percentage Offset&quot;</span><span class="p">,</span> <span class="s2">&quot;Absolute Offset&quot;</span><span class="p">,</span> <span class="s2">&quot;Absolute Offset&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">ipk</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_objects_by_material</span><span class="p">(</span><span class="s2">&quot;air&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">subregion</span> <span class="o">=</span> <span class="n">ipk</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_subregion</span><span class="p">(</span><span class="n">padding_values</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="n">padding_types</span><span class="o">=</span><span class="s2">&quot;Percentage Offset&quot;</span><span class="p">,</span> <span class="n">assignment</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dc_terminal&quot;</span><span class="p">,</span> <span class="s2">&quot;dc_terminal_1_2&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Subregion&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Assign-EM-losses">
<h2>Assign EM losses<a class="headerlink" href="#Assign-EM-losses" title="Link to this heading">#</a></h2>
<p>Assign EM losses from Q3D to the objects imported in Icepak. Set the harmonic loss values computed in Q3D as intrinsic values for the EM loss boundary condition.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variables_mapping</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">q3d</span><span class="o">.</span><span class="n">variable_manager</span><span class="o">.</span><span class="n">design_variables</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">variables_mapping</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">expression</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipk</span><span class="o">.</span><span class="n">assign_em_losses</span><span class="p">(</span>
    <span class="n">design</span><span class="o">=</span><span class="n">Q3D_DESIGN_NAME</span><span class="p">,</span>
    <span class="n">setup</span><span class="o">=</span><span class="s2">&quot;Setup1&quot;</span><span class="p">,</span>
    <span class="n">sweep</span><span class="o">=</span><span class="s2">&quot;LastAdaptive&quot;</span><span class="p">,</span>
    <span class="n">parameters</span><span class="o">=</span><span class="n">variables_mapping</span><span class="p">,</span>
    <span class="n">assignment</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dc_terminal&quot;</span><span class="p">,</span> <span class="s2">&quot;dc_terminal_1_2&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Boundary EMLoss EMLoss_GZ11YQ has been created.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
EMLoss_GZ11YQ
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">q3d</span><span class="o">.</span><span class="n">design_datasets</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">v</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="si">}{</span><span class="n">q3d</span><span class="o">.</span><span class="n">design_datasets</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">xunit</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">q3d</span><span class="o">.</span><span class="n">design_datasets</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">EM_loss</span> <span class="o">=</span> <span class="n">ipk</span><span class="o">.</span><span class="n">boundaries_by_type</span><span class="p">[</span><span class="s2">&quot;EMLoss&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">EM_loss</span><span class="o">.</span><span class="n">auto_update</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">EM_loss</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;ForceSourceToSolve&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">EM_loss</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;PreservePartnerSoln&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">EM_loss</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Intrinsics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;500MHz&quot;</span><span class="p">]</span>
<span class="n">EM_loss</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Q3DEMLossType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;HarmonicLoss&quot;</span>
<span class="n">EM_loss</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;IntrinsicsHarmonicLoss&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
<span class="n">EM_loss</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;HarmonicLossSweepCoupling&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">EM_loss</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="Assign-stationary-wall-boundary-condition">
<h2>Assign stationary wall boundary condition<a class="headerlink" href="#Assign-stationary-wall-boundary-condition" title="Link to this heading">#</a></h2>
<p>Assign stationary wall boundary condition with temperature to the sources</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipk</span><span class="o">.</span><span class="n">assign_stationary_wall_with_temperature</span><span class="p">(</span>
    <span class="n">geometry</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;module_a_minus&quot;</span><span class="p">,</span> <span class="s2">&quot;module_a_plus&quot;</span><span class="p">,</span> <span class="s2">&quot;module_b_minus&quot;</span><span class="p">,</span> <span class="s2">&quot;module_b_plus&quot;</span><span class="p">,</span> <span class="s2">&quot;module_c_minus&quot;</span><span class="p">,</span> <span class="s2">&quot;module_c_plus&quot;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stationary_wall&quot;</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
    <span class="n">thickness</span><span class="o">=</span><span class="s2">&quot;10mm&quot;</span><span class="p">,</span>
    <span class="n">material</span><span class="o">=</span><span class="s2">&quot;Al-Extruded&quot;</span><span class="p">,</span>
    <span class="n">radiate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">radiate_surf_mat</span><span class="o">=</span><span class="s2">&quot;Steel-oxidised-surface&quot;</span><span class="p">,</span>
    <span class="n">shell_conduction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Boundary Stationary Wall stationary_wall has been created.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
stationary_wall
</pre></div></div>
</div>
</section>
<section id="Icepak-setup">
<h2>Icepak setup<a class="headerlink" href="#Icepak-setup" title="Link to this heading">#</a></h2>
<p>Set Temperature as the only problem type in the Icepak setup</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">setup</span> <span class="o">=</span> <span class="n">ipk</span><span class="o">.</span><span class="n">create_setup</span><span class="p">()</span>
<span class="n">setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Include Flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">ipk</span><span class="o">.</span><span class="n">analyze_setup</span><span class="p">(</span><span class="n">ipk</span><span class="o">.</span><span class="n">setups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Solving design setup Setup
PyAEDT INFO: Design setup Setup solved correctly in 0.0h 1.0m 27.0s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="Analysis">
<h2>Analysis<a class="headerlink" href="#Analysis" title="Link to this heading">#</a></h2>
<p>Analyze the Icepak design</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipk</span><span class="o">.</span><span class="n">analyze_setup</span><span class="p">(</span><span class="n">ipk</span><span class="o">.</span><span class="n">setups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Solving design setup Setup
PyAEDT INFO: Design setup Setup solved correctly in 0.0h 0.0m 15.0s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="Icepak-Post-processing">
<h2>Icepak Post-processing<a class="headerlink" href="#Icepak-Post-processing" title="Link to this heading">#</a></h2>
<p>Post-processing: plot temperature distribution and volumetric heat loss on the surface of the objects</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="n">ipk</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_fieldplot_surface</span><span class="p">(</span><span class="n">assignment</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dc_terminal&quot;</span><span class="p">,</span> <span class="s2">&quot;dc_terminal_1_2&quot;</span><span class="p">],</span> <span class="n">quantity</span><span class="o">=</span><span class="s2">&quot;Temperature&quot;</span><span class="p">,</span> <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;Temperature&quot;</span><span class="p">)</span>
<span class="n">vol_heat_loss</span> <span class="o">=</span> <span class="n">ipk</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_fieldplot_volume</span><span class="p">(</span><span class="n">assignment</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dc_terminal&quot;</span><span class="p">,</span> <span class="s2">&quot;dc_terminal_1_2&quot;</span><span class="p">],</span> <span class="n">quantity</span><span class="o">=</span><span class="s2">&quot;VolumeHeatLoss&quot;</span><span class="p">,</span> <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;VolumeHeatLoss&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Parsing C:\Users\ansys\AppData\Local\Temp\tmp61xontsz.ansys\q3d_dynamic_link\busbar_q3d_tb.aedt.
PyAEDT INFO: File C:\Users\ansys\AppData\Local\Temp\tmp61xontsz.ansys\q3d_dynamic_link\busbar_q3d_tb.aedt correctly loaded. Elapsed time: 0m 1sec
PyAEDT INFO: aedt file load time 0.6480751037597656
PyAEDT INFO: PostProcessor class has been initialized! Elapsed time: 0m 1sec
PyAEDT INFO: Post class has been initialized! Elapsed time: 0m 1sec
PyAEDT INFO: Active Design set to Icepak_1
PyAEDT INFO: Materials class has been initialized! Elapsed time: 0m 0sec
PyAEDT INFO: Active Design set to Icepak_1
</pre></div></div>
</div>
</section>
<section id="Release-AEDT">
<h2>Release AEDT<a class="headerlink" href="#Release-AEDT" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tb</span><span class="o">.</span><span class="n">save_project</span><span class="p">()</span>
<span class="n">tb</span><span class="o">.</span><span class="n">release_desktop</span><span class="p">()</span>
<span class="c1"># Wait 3 seconds to allow AEDT to shut down before cleaning the temporary directory.</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Project busbar_q3d_tb Saved correctly
PyAEDT INFO: Desktop has been released and closed.
</pre></div></div>
</div>
</section>
<section id="Clean-up">
<h2>Clean up<a class="headerlink" href="#Clean-up" title="Link to this heading">#</a></h2>
<p>All project files are saved in the folder <code class="docutils literal notranslate"><span class="pre">temp_folder.name</span></code>. If youve run this example as a Jupyter notebook, you can retrieve those project files. The following cell removes all temporary files, including the project folder.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_folder</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<div class="admonition-download-this-example admonition">
<p class="admonition-title">Download this example</p>
<p>Download this example as a <a class="reference external" href="https://examples.aedt.docs.pyansys.com/version/dev/examples/electrothermal/three_phase_inverter.ipynb">Jupyter Notebook</a>
or as a <a class="reference external" href="https://examples.aedt.docs.pyansys.com/version/dev/examples/electrothermal/three_phase_inverter.py">Python script</a>.</p>
</div>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Perform-imports-and-define-constants">Perform imports and define constants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Define-constants">Define constants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Create-temporary-directory">Create temporary directory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Download-AEDT-file">Download AEDT file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Launch-Maxwell-AEDT">Launch Maxwell AEDT</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Add-Q3D-component-to-Twinbuilder-schematic">Add Q3D component to Twinbuilder schematic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Place-component-on-schematic">Place component on schematic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Solve-transient-setup">Solve transient setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Twinbuilder-Post-processing-:-Time-domain">Twinbuilder Post-processing : Time domain</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Twinbuilder-Post-processing-:-Frequency-domain">Twinbuilder Post-processing : Frequency domain</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Filter-data">Filter data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Q3D:-Harmonic-loss-setup">Q3D: Harmonic loss setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Q3D-Post-processing">Q3D Post-processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Create-Icepak-Design">Create Icepak Design</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Copy-bodies-from-Q3D-to-Icepak">Copy bodies from Q3D to Icepak</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Change-region-padding-and-create-subregion">Change region padding and create subregion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Assign-EM-losses">Assign EM losses</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Assign-stationary-wall-boundary-condition">Assign stationary wall boundary condition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Icepak-setup">Icepak setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Analysis">Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Icepak-Post-processing">Icepak Post-processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Release-AEDT">Release AEDT</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Clean-up">Clean up</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item"> 
<div class="tocsection editthispage">
  <a href="https://github.com/ansys/pyaedt-examples/edit/main/doc/source/examples/electrothermal/three_phase_inverter.ipynb">
    <i class="fa-solid fa-pencil"></i>
       Edit
    on GitHub  
  </a>
</div>

</div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/examples/electrothermal/three_phase_inverter.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
       Copyright (c) 2021 - 2026 ANSYS, Inc. All rights reserved.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the
  <a href="https://sphinxdocs.ansys.com/version/stable/index.html"
    >Ansys Sphinx Theme</a
  >
  1.0.11. <br />Last updated on
  <span id="date"></span>
</p>
<script>
  var options = { day: "numeric", month: "long", year: "numeric" };
  var lastModifiedDate = new Date(document.lastModified);
  var date = lastModifiedDate.toLocaleDateString("en-US", options);
  document.getElementById("date").innerHTML = date;
</script></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>