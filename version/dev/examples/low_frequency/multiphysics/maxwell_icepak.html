
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Maxwell 3D-Icepak electrothermal analysis &#8212; PyAEDT Examples</title>

  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css\ansys_sphinx_theme.css?v=d2ac875c" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" type="text/css" href="https://www.nerdfonts.com/assets/css/webfont.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=9233c59b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/highlight.css?v=500661c4" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>
 
<link href="../../../_static/css/breadcrumbs.css" rel="stylesheet" />

    <script src="../../../_static/documentation_options.js?v=e7fb764e"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=49e1bf35"></script>
    <script src="../../../_static/js\table.js?v=b64f5182"></script>
    <script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/low_frequency/multiphysics/maxwell_icepak';</script>
    <link rel="icon" href="../../../_static/ansys-favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Electrothermal" href="../../electrothermal/index.html" />
    <link rel="prev" title="Multiphysics" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <link rel="canonical" href="https://examples.aedt.docs.pyansys.com/version/stable/examples/low_frequency/multiphysics/maxwell_icepak.html" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container"><!-- Debugging: html_theme_options =  -->

  <!-- If there is no MeiliSearch enabled, use the PyData search -->
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

   
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="https://www.ansys.com/">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/ansys_logo_transparent_black.png" class="logo__image only-light" alt="PyAEDT Examples - Home"/>
    <script>document.write(`<img src="../../../_static/ansys_logo_transparent_white.png" class="logo__image only-dark" alt="PyAEDT Examples - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyaedt-examples" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyaedt-examples/discussions" title="Support" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comment fa-fw fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Support</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
    

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyaedt-examples" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyaedt-examples/discussions" title="Support" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comment fa-fw fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Support</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../aedt/index.html">Examples by AEDT application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../high_frequency/index.html">High frequency</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Low frequency</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../general/index.html">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="../motor/index.html">Motor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../magnetic/index.html">Magnetics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../team_problem/index.html">T.E.A.M.</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="index.html">Multiphysics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Maxwell 3D-Icepak electrothermal analysis</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../aedt_general/report/index.html">Report</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../electrothermal/index.html">Electrothermal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aedt_general/index.html">Pre-processing and post-processing</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">
<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
         
    <li class="breadcrumb-item breadcrumb-home">
      <a href="https://docs.pyansys.com/" class="nav-link">PyAnsys</a>
    </li>
       
    <li class="breadcrumb-item">
      <a href="https://aedt.docs.pyansys.com/" class="nav-link">PyAEDT</a>
    </li>
     
    <li class="breadcrumb-item">
      <a
        href="../../../index.html"
        class="nav-link"
        aria-label="Home"
      >
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
     
    <li class="breadcrumb-item">
      <a href="../../index.html" class="nav-link">Examples</a>
    </li>
     
    <li class="breadcrumb-item">
      <a href="../index.html" class="nav-link">Low frequency</a>
    </li>
     
    <li class="breadcrumb-item">
      <a href="index.html" class="nav-link">Multiphysics</a>
    </li>
      
    <li class="breadcrumb-item active" aria-current="page">Maxwell 3D-Icepak electrothermal analysis</li>
    
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="admonition-download-this-example admonition">
<p class="admonition-title">Download this example</p>
<p>Download this example as a <a class="reference external" href="https://examples.aedt.docs.pyansys.com/version/dev/examples/low_frequency/multiphysics/maxwell_icepak.ipynb">Jupyter Notebook</a>
or as a <a class="reference external" href="https://examples.aedt.docs.pyansys.com/version/dev/examples/low_frequency/multiphysics/maxwell_icepak.py">Python script</a>.</p>
</div>
<hr class="docutils" />
<section id="Maxwell-3D-Icepak-electrothermal-analysis">
<h1>Maxwell 3D-Icepak electrothermal analysis<a class="headerlink" href="#Maxwell-3D-Icepak-electrothermal-analysis" title="Link to this heading">#</a></h1>
<p>This example uses PyAEDT to set up a simple Maxwell design consisting of a coil and a ferrite core. Coil current is set to 100A, and coil resistance and ohmic loss are analyzed. Ohmic loss is mapped to Icepak, and a thermal analysis is performed. Icepak calculates a temperature distribution, and it is mapped back to Maxwell (2-way coupling). Coil resistance and ohmic loss are analyzed again in Maxwell. Results are printed in AEDT Message Manager.</p>
<p>Keywords: <strong>Multiphysics</strong>, <strong>Maxwell</strong>, <strong>Icepak</strong>, <strong>Wireless Charging</strong>.</p>
<section id="Prerequisites">
<h2>Prerequisites<a class="headerlink" href="#Prerequisites" title="Link to this heading">#</a></h2>
<section id="Perform-imports">
<h3>Perform imports<a class="headerlink" href="#Perform-imports" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ansys.aedt.core</span>  <span class="c1"># Interface to Ansys Electronics Desktop</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ansys.aedt.core.generic.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axis</span>
</pre></div>
</div>
</div>
</section>
<section id="Define-constants">
<h3>Define constants<a class="headerlink" href="#Define-constants" title="Link to this heading">#</a></h3>
<p>Constants help ensure consistency and avoid repetition throughout the example.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">AEDT_VERSION</span> <span class="o">=</span> <span class="s2">&quot;2025.2&quot;</span>
<span class="n">NG_MODE</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Open AEDT UI when it is launched.</span>
</pre></div>
</div>
</div>
</section>
<section id="Create-temporary-directory">
<h3>Create temporary directory<a class="headerlink" href="#Create-temporary-directory" title="Link to this heading">#</a></h3>
<p>Create a temporary working directory. The name of the working folder is stored in <code class="docutils literal notranslate"><span class="pre">temp_folder.name</span></code>.</p>
<blockquote>
<div><p><strong>Note:</strong> The final cell in this example removes the temporary folder and all contents. If you want to retrieve the AEDT project and data, do so before executing the final cell in the notebook.</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_folder</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.ansys&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Launch-application">
<h3>Launch application<a class="headerlink" href="#Launch-application" title="Link to this heading">#</a></h3>
<p>The syntax for different applications in AEDT differ only in the name of the class. This example demonstrates the use of the <code class="docutils literal notranslate"><span class="pre">Maxwell3d</span></code> and <code class="docutils literal notranslate"><span class="pre">Icepak</span></code> classes.</p>
<blockquote>
<div><p><strong>Note:</strong> An AEDT <em>Project</em> is created when the <code class="docutils literal notranslate"><span class="pre">Maxwell3d</span></code> class is instantiated. An instance of the <code class="docutils literal notranslate"><span class="pre">Icepak</span></code> class will be used later to insert and simulate an Icepak design to demonstrate the coupled electrical-thermal workflow.</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maxwell_design_name</span> <span class="o">=</span> <span class="s2">&quot;1 Maxwell&quot;</span>
<span class="n">icepak_design_name</span> <span class="o">=</span> <span class="s2">&quot;2 Icepak&quot;</span>

<span class="n">project_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_folder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;Maxwell-Icepak-2way-Coupling&quot;</span><span class="p">)</span>

<span class="n">m3d</span> <span class="o">=</span> <span class="n">ansys</span><span class="o">.</span><span class="n">aedt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Maxwell3d</span><span class="p">(</span>
    <span class="n">project</span><span class="o">=</span><span class="n">project_name</span><span class="p">,</span>
    <span class="n">design</span><span class="o">=</span><span class="n">maxwell_design_name</span><span class="p">,</span>
    <span class="n">solution_type</span><span class="o">=</span><span class="s2">&quot;EddyCurrent&quot;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="n">AEDT_VERSION</span><span class="p">,</span>
    <span class="n">non_graphical</span><span class="o">=</span><span class="n">NG_MODE</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Python version 3.10.11 (tags/v3.10.11:7d4cc5a, Apr  5 2023, 00:38:17) [MSC v.1929 64 bit (AMD64)].
PyAEDT INFO: PyAEDT version 0.25.dev0.
PyAEDT INFO: Initializing new Desktop session.
PyAEDT INFO: Log on console is enabled.
PyAEDT INFO: Log on file C:\Users\ansys\AppData\Local\Temp\pyaedt_ansys_afec6722-e8d8-4548-89de-52d36439fd96.log is enabled.
PyAEDT INFO: Log on AEDT is disabled.
PyAEDT INFO: Starting new AEDT gRPC session.
PyAEDT INFO: AEDT installation Path C:\Program Files\ANSYS Inc\v252\AnsysEM
PyAEDT INFO: Client application successfully started.
PyAEDT INFO: New AEDT gRPC session session started on port 50051.
PyAEDT INFO: 2025.2 version started with process ID 8160.
PyAEDT WARNING: Service Pack is not detected. PyAEDT is currently connecting in Insecure Mode.
PyAEDT WARNING: Please download and install latest Service Pack to use connect to AEDT in Secure Mode.
PyAEDT INFO: Debug logger is disabled. PyAEDT methods will not be logged.
PyAEDT INFO: Project Maxwell-Icepak-2way-Coupling has been created.
PyAEDT INFO: Added design &#39;1 Maxwell&#39; of type Maxwell 3D.
PyAEDT INFO: Aedt Objects correctly read
</pre></div></div>
</div>
</section>
</section>
<section id="Model-Preparation">
<h2>Model Preparation<a class="headerlink" href="#Model-Preparation" title="Link to this heading">#</a></h2>
<section id="Build-the-model">
<h3>Build the model<a class="headerlink" href="#Build-the-model" title="Link to this heading">#</a></h3>
<p>Create the coil, coil terminal, core, and surrounding air region. The coil and core are created by drawing a rectangle and sweeping it about the z-axis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coil_origin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">]</span>  <span class="c1"># [x, y, z] position of the rectangle origin.</span>
<span class="n">coil_xsection</span> <span class="o">=</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">110</span><span class="p">]</span>  <span class="c1"># [z-size, x-size]</span>
<span class="n">core_origin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">45</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">18</span><span class="p">]</span>
<span class="n">core_xsection</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">160</span><span class="p">]</span>

<span class="n">coil</span> <span class="o">=</span> <span class="n">m3d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">(</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;XZ&quot;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">coil_origin</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="n">coil_xsection</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Coil&quot;</span>
<span class="p">)</span>
<span class="n">coil</span><span class="o">.</span><span class="n">sweep_around_axis</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">Z</span><span class="p">)</span>
<span class="n">coil_terminal</span> <span class="o">=</span> <span class="n">m3d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">(</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;XZ&quot;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">coil_origin</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="n">coil_xsection</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Coil_terminal&quot;</span>
<span class="p">)</span>

<span class="n">core</span> <span class="o">=</span> <span class="n">m3d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">(</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;XZ&quot;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">core_origin</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="n">core_xsection</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Core&quot;</span>
<span class="p">)</span>
<span class="n">core</span><span class="o">.</span><span class="n">sweep_around_axis</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">Z</span><span class="p">)</span>

<span class="c1"># The air region should be sufficiently large to avoid interaction with the</span>
<span class="c1"># coil magnetic field.</span>

<span class="n">region</span> <span class="o">=</span> <span class="n">m3d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_region</span><span class="p">(</span><span class="n">pad_percent</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Modeler class has been initialized! Elapsed time: 0m 1sec
PyAEDT INFO: Materials class has been initialized! Elapsed time: 0m 0sec
</pre></div></div>
</div>
<section id="Restore-view">
<h4>Restore view<a class="headerlink" href="#Restore-view" title="Link to this heading">#</a></h4>
<p>If you are using PyAEDT with an interactive desktop, you may want to fit the visible view to fit the model. PyAEDT allows direct access to the native API for this command using the property <code class="docutils literal notranslate"><span class="pre">m3d.odesktop</span></code>.</p>
<p>Uncomment and run the following cell if you are running PyAEDT interactively and would like to automatically fit the window to the model.</p>
<blockquote>
<div><p><strong>Note:</strong> Native API calls do not allow for introspection or follow PIP syntax guidelines. Full documentation for the native API is available in the built-in AEDT <a class="reference external" href="https://ansyshelp.ansys.com/account/secured?returnurl=/Views/Secured/Electronics/v242/en//Subsystems/Maxwell/Subsystems/Maxwell%20Scripting/Maxwell%20Scripting.htm">help</a>.</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># desktop=m3d.odesktop.RestoreWindow()  # Fit the active view</span>
<span class="c1"># desktop = m3d.post.still_focus_oneditor()</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Create-and-assign-material">
<h3>Create and assign material<a class="headerlink" href="#Create-and-assign-material" title="Link to this heading">#</a></h3>
<p>Define a new material for the AWG40 Litz wire copper strands:</p>
<ul class="simple">
<li><p>Strand diameter = 0.08 mm</p></li>
<li><p>Number of parallel strands in the Litz wire = 24</p></li>
</ul>
<p>The built-in material “ferrite” will be assigned to the core. The material “vacuum” will be assigned to the outer region.</p>
<p>You will also see the return value when <code class="docutils literal notranslate"><span class="pre">True</span></code> printed when material is successfully assigned.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">no_strands</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">strand_diameter</span> <span class="o">=</span> <span class="mf">0.08</span>

<span class="n">cu_litz</span> <span class="o">=</span> <span class="n">m3d</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">duplicate_material</span><span class="p">(</span><span class="s2">&quot;copper&quot;</span><span class="p">,</span> <span class="s2">&quot;copper_litz&quot;</span><span class="p">)</span>
<span class="n">cu_litz</span><span class="o">.</span><span class="n">stacking_type</span> <span class="o">=</span> <span class="s2">&quot;Litz Wire&quot;</span>
<span class="n">cu_litz</span><span class="o">.</span><span class="n">wire_diameter</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">strand_diameter</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;mm&quot;</span>
<span class="n">cu_litz</span><span class="o">.</span><span class="n">wire_type</span> <span class="o">=</span> <span class="s2">&quot;Round&quot;</span>
<span class="n">cu_litz</span><span class="o">.</span><span class="n">strand_number</span> <span class="o">=</span> <span class="n">no_strands</span>

<span class="n">m3d</span><span class="o">.</span><span class="n">assign_material</span><span class="p">(</span><span class="n">region</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;vacuum&quot;</span><span class="p">)</span>
<span class="n">m3d</span><span class="o">.</span><span class="n">assign_material</span><span class="p">(</span><span class="n">coil</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;copper_litz&quot;</span><span class="p">)</span>
<span class="n">m3d</span><span class="o">.</span><span class="n">assign_material</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;ferrite&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="Define-the-source">
<h3>Define the source<a class="headerlink" href="#Define-the-source" title="Link to this heading">#</a></h3>
<p>The coil carries 0.5 A and 20 turns.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">turns</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">wire_current</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">m3d</span><span class="o">.</span><span class="n">assign_coil</span><span class="p">([</span><span class="s2">&quot;Coil_terminal&quot;</span><span class="p">],</span> <span class="n">conductors_number</span><span class="o">=</span><span class="n">turns</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Coil_terminal&quot;</span><span class="p">)</span>
<span class="n">m3d</span><span class="o">.</span><span class="n">assign_winding</span><span class="p">(</span><span class="n">is_solid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">current</span><span class="o">=</span><span class="n">wire_current</span> <span class="o">*</span> <span class="n">turns</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Winding1&quot;</span><span class="p">)</span>

<span class="n">m3d</span><span class="o">.</span><span class="n">add_winding_coils</span><span class="p">(</span><span class="n">assignment</span><span class="o">=</span><span class="s2">&quot;Winding1&quot;</span><span class="p">,</span> <span class="n">coils</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Coil_terminal&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Boundary CoilTerminal Coil_terminal has been created.
PyAEDT INFO: Boundary Winding Winding1 has been created.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="Assign-mesh-operations">
<h3>Assign mesh operations<a class="headerlink" href="#Assign-mesh-operations" title="Link to this heading">#</a></h3>
<p>Mesh “seeding” is used to accelerate the auto-adaptive mesh refinement.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m3d</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">assign_length_mesh</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;Core&quot;</span><span class="p">],</span> <span class="n">maximum_length</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">maximum_elements</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Inside_Core&quot;</span>
<span class="p">)</span>
<span class="n">m3d</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">assign_length_mesh</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;Coil&quot;</span><span class="p">],</span> <span class="n">maximum_length</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">maximum_elements</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Inside_Coil&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Mesh class has been initialized! Elapsed time: 0m 0sec
PyAEDT INFO: Mesh class has been initialized! Elapsed time: 0m 0sec
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Inside_Coil
</pre></div></div>
</div>
</section>
<section id="Set-object-temperature-and-enable-feedback">
<h3>Set object temperature and enable feedback<a class="headerlink" href="#Set-object-temperature-and-enable-feedback" title="Link to this heading">#</a></h3>
<p>The impact of Joule heating on conductivity can be considered by adding a “thermal modifier” to the <code class="docutils literal notranslate"><span class="pre">cu_litz</span></code> material definition. In this example, conductivity increases by 0.393% per <span class="math notranslate nohighlight">\(\Delta^o\)</span>C. The temperature of the objects is set to the default value (<span class="math notranslate nohighlight">\(22^o\)</span>C).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cu_resistivity_temp_coefficient</span> <span class="o">=</span> <span class="mf">0.00393</span>
<span class="n">cu_litz</span><span class="o">.</span><span class="n">conductivity</span><span class="o">.</span><span class="n">add_thermal_modifier_free_form</span><span class="p">(</span>
    <span class="s2">&quot;1.0/(1.0+</span><span class="si">{}</span><span class="s2">*(Temp-20))&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cu_resistivity_temp_coefficient</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">m3d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">set_objects_temperature</span><span class="p">([</span><span class="s2">&quot;Coil&quot;</span><span class="p">],</span> <span class="n">ambient_temperature</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Set model temperature and enabling Thermal Feedback
PyAEDT INFO: Assigned Objects Temperature
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="Assign-the-matrix-calculation-to-the-winding">
<h3>Assign the matrix calculation to the winding<a class="headerlink" href="#Assign-the-matrix-calculation-to-the-winding" title="Link to this heading">#</a></h3>
<p>The resistance and inductance calculations for the coil are enabled by adding the matrix assignment to the winding.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m3d</span><span class="o">.</span><span class="n">assign_matrix</span><span class="p">([</span><span class="s2">&quot;Winding1&quot;</span><span class="p">],</span> <span class="n">matrix_name</span><span class="o">=</span><span class="s2">&quot;Matrix1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Infinite is the only return path option in EddyCurrent.
PyAEDT INFO: Boundary Matrix Matrix1 has been created.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Matrix1
</pre></div></div>
</div>
</section>
<section id="Create-the-simulation-setup">
<h3>Create the simulation setup<a class="headerlink" href="#Create-the-simulation-setup" title="Link to this heading">#</a></h3>
<p>The simulation frequency is 150 kHz. You can query and modify the properties of the simulation setup using <code class="docutils literal notranslate"><span class="pre">setup.props</span></code>. The “PercentError” establishes the minimum allowed change in energy due to the change in mesh size and ensure a small global solution error.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">setup</span> <span class="o">=</span> <span class="n">m3d</span><span class="o">.</span><span class="n">create_setup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Setup1&quot;</span><span class="p">)</span>
<span class="n">setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Frequency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;150kHz&quot;</span>
<span class="n">setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;MaximumPasses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;PercentError&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;MinimumConvergedPasses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</section>
<section id="Run-the-Maxwell-3D-analysis">
<h3>Run the Maxwell 3D analysis<a class="headerlink" href="#Run-the-Maxwell-3D-analysis" title="Link to this heading">#</a></h3>
<p>The following command runs the 3D finite element analysis in Maxwell.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m3d</span><span class="o">.</span><span class="n">analyze_setup</span><span class="p">(</span><span class="s2">&quot;Setup1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Solving design setup Setup1
PyAEDT INFO: Design setup Setup1 solved correctly in 0.0h 1.0m 59.0s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
</section>
<section id="Postprocessing">
<h2>Postprocessing<a class="headerlink" href="#Postprocessing" title="Link to this heading">#</a></h2>
<section id="DC-resistance">
<h3>DC resistance<a class="headerlink" href="#DC-resistance" title="Link to this heading">#</a></h3>
<p>The DC resistance of the coil can be calculated analyticially. The following cell compares the known DC resistance with the simulated coil resistance.</p>
<p>The values can be displayed in the AEDT “Message Manager”. The Ohmic loss in coil is calculated and displayed so we can see the change when Joule heating is considered.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">report</span> <span class="o">=</span> <span class="n">m3d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span><span class="n">expressions</span><span class="o">=</span><span class="s2">&quot;Matrix1.R(Winding1,Winding1)&quot;</span><span class="p">)</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">get_solution_data</span><span class="p">()</span>
<span class="n">resistance</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">get_expression_data</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;magnitude&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Resistance is the first matrix element.</span>

<span class="n">report_loss</span> <span class="o">=</span> <span class="n">m3d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span><span class="n">expressions</span><span class="o">=</span><span class="s2">&quot;StrandedLossAC&quot;</span><span class="p">)</span>
<span class="n">solution_loss</span> <span class="o">=</span> <span class="n">report_loss</span><span class="o">.</span><span class="n">get_solution_data</span><span class="p">()</span>
<span class="n">em_loss</span> <span class="o">=</span> <span class="n">solution_loss</span><span class="o">.</span><span class="n">get_expression_data</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;magnitude&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Parsing C:\Users\ansys\AppData\Local\Temp\tmp1vwxzrwl.ansys\Maxwell-Icepak-2way-Coupling.aedt.
PyAEDT INFO: File C:\Users\ansys\AppData\Local\Temp\tmp1vwxzrwl.ansys\Maxwell-Icepak-2way-Coupling.aedt correctly loaded. Elapsed time: 0m 0sec
PyAEDT INFO: aedt file load time 0.016083240509033203
PyAEDT INFO: PostProcessor class has been initialized! Elapsed time: 0m 0sec
PyAEDT INFO: PostProcessor class has been initialized! Elapsed time: 0m 0sec
PyAEDT INFO: Post class has been initialized! Elapsed time: 0m 0sec
PyAEDT WARNING: No report category provided. Automatically identified AC Magnetic
PyAEDT INFO: Solution Data Correctly Loaded.
Time to initialize solution data:0.017018795013427734
Time to initialize solution data:0.017018795013427734
PyAEDT WARNING: No report category provided. Automatically identified AC Magnetic
PyAEDT INFO: Solution Data Correctly Loaded.
Time to initialize solution data:0.0
Time to initialize solution data:0.0
</pre></div></div>
</div>
</section>
<section id="Analyitic-calculation-of-DC-resistance">
<h3>Analyitic calculation of DC resistance<a class="headerlink" href="#Analyitic-calculation-of-DC-resistance" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cu_cond</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cu_litz</span><span class="o">.</span><span class="n">conductivity</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="c1"># Average radius of a coil turn = 125 mm</span>
<span class="n">avg_coil_radius</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">coil_xsection</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">coil_origin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
<span class="p">)</span> <span class="o">*</span> <span class="mf">0.001</span>  <span class="c1"># Convert to meters</span>
<span class="n">l_conductor</span> <span class="o">=</span> <span class="n">turns</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">avg_coil_radius</span> <span class="o">*</span> <span class="mf">3.1415</span>

<span class="c1"># R = resistivity * length / area / no_strand</span>
<span class="n">r_analytic_DC</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">cu_cond</span><span class="p">)</span>
    <span class="o">*</span> <span class="n">l_conductor</span>
    <span class="o">/</span> <span class="p">(</span><span class="mf">3.1415</span> <span class="o">*</span> <span class="p">(</span><span class="n">strand_diameter</span> <span class="o">*</span> <span class="mf">0.001</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="o">/</span> <span class="n">no_strands</span>
<span class="p">)</span>

<span class="c1"># Print results in AEDT Message Manager</span>
<span class="n">m3d</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;*******Coil analytical DC resistance =  </span><span class="si">{</span><span class="n">r_analytic_DC</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">Ohm&quot;</span><span class="p">)</span>
<span class="n">m3d</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;*******Coil resistance at 150kHz BEFORE temperature feedback =  </span><span class="si">{</span><span class="n">resistance</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">Ohm&quot;</span>
<span class="p">)</span>
<span class="n">m3d</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;*******Ohmic loss in coil BEFORE temperature feedback =  </span><span class="si">{</span><span class="n">em_loss</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">W&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: *******Coil analytical DC resistance =  1.62Ohm
PyAEDT INFO: *******Coil resistance at 150kHz BEFORE temperature feedback =  0.00Ohm
PyAEDT INFO: *******Ohmic loss in coil BEFORE temperature feedback =  0.00W
</pre></div></div>
</div>
</section>
</section>
<section id="Create-the-thermal-model">
<h2>Create the thermal model<a class="headerlink" href="#Create-the-thermal-model" title="Link to this heading">#</a></h2>
<p>The following commands insert an Icepak design into the AEDT project, copies the solid objects from Maxwell 3D, and modifies the region dimensions so they’re suitable for thermal convection analysis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipk</span> <span class="o">=</span> <span class="n">ansys</span><span class="o">.</span><span class="n">aedt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Icepak</span><span class="p">(</span><span class="n">design</span><span class="o">=</span><span class="n">icepak_design_name</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">AEDT_VERSION</span><span class="p">)</span>
<span class="n">ipk</span><span class="o">.</span><span class="n">copy_solid_bodies_from</span><span class="p">(</span><span class="n">m3d</span><span class="p">,</span> <span class="n">no_pec</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Set domain dimensions suitable for natural convection using the diameter of the coil</span>
<span class="n">ipk</span><span class="o">.</span><span class="n">modeler</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
<span class="n">coil_dim</span> <span class="o">=</span> <span class="n">coil</span><span class="o">.</span><span class="n">bounding_dimension</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ipk</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_region</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">ipk</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">edit_region_dimensions</span><span class="p">(</span>
    <span class="p">[</span><span class="n">coil_dim</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">coil_dim</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">coil_dim</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">coil_dim</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">coil_dim</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">coil_dim</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Python version 3.10.11 (tags/v3.10.11:7d4cc5a, Apr  5 2023, 00:38:17) [MSC v.1929 64 bit (AMD64)].
PyAEDT INFO: PyAEDT version 0.25.dev0.
PyAEDT INFO: Returning found Desktop session with PID 8160!
PyAEDT INFO: No project is defined. Project Maxwell-Icepak-2way-Coupling exists and has been read.
PyAEDT INFO: Added design &#39;2 Icepak&#39; of type Icepak.
PyAEDT INFO: Aedt Objects correctly read
PyAEDT INFO: Modeler class has been initialized! Elapsed time: 0m 0sec
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<section id="Map-coil-losses">
<h3>Map coil losses<a class="headerlink" href="#Map-coil-losses" title="Link to this heading">#</a></h3>
<p>Map ohmic losses from Maxwell 3D to the Icepak design.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipk</span><span class="o">.</span><span class="n">assign_em_losses</span><span class="p">(</span>
    <span class="n">design</span><span class="o">=</span><span class="s2">&quot;1 Maxwell&quot;</span><span class="p">,</span>
    <span class="n">setup</span><span class="o">=</span><span class="n">m3d</span><span class="o">.</span><span class="n">setups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
    <span class="n">sweep</span><span class="o">=</span><span class="s2">&quot;LastAdaptive&quot;</span><span class="p">,</span>
    <span class="n">assignment</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Coil&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Boundary EMLoss EMLoss_CR6UMB has been created.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
EMLoss_CR6UMB
</pre></div></div>
</div>
</section>
<section id="Define-boundary-conditions">
<h3>Define boundary conditions<a class="headerlink" href="#Define-boundary-conditions" title="Link to this heading">#</a></h3>
<p>Assign the opening in the Icepak model to allow free airflow.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">faces</span> <span class="o">=</span> <span class="n">ipk</span><span class="o">.</span><span class="n">modeler</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">faces</span>
<span class="n">face_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">face</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="n">faces</span><span class="p">]</span>
<span class="n">ipk</span><span class="o">.</span><span class="n">assign_free_opening</span><span class="p">(</span><span class="n">face_names</span><span class="p">,</span> <span class="n">boundary_name</span><span class="o">=</span><span class="s2">&quot;Opening1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Boundary Opening Opening1 has been created.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Opening1
</pre></div></div>
</div>
</section>
<section id="Assign-monitor">
<h3>Assign monitor<a class="headerlink" href="#Assign-monitor" title="Link to this heading">#</a></h3>
<p>Assign a temperature monitor on the coil surface.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_monitor</span> <span class="o">=</span> <span class="n">ipk</span><span class="o">.</span><span class="n">assign_point_monitor</span><span class="p">([</span><span class="mi">70</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">monitor_name</span><span class="o">=</span><span class="s2">&quot;PointMonitor1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Set-up-Icepak-solution">
<h3>Set up Icepak solution<a class="headerlink" href="#Set-up-Icepak-solution" title="Link to this heading">#</a></h3>
<p>Icepak solution settings are modified by updating the <code class="docutils literal notranslate"><span class="pre">props</span></code> associated with the solution setup.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solution_setup</span> <span class="o">=</span> <span class="n">ipk</span><span class="o">.</span><span class="n">create_setup</span><span class="p">()</span>
<span class="n">solution_setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Convergence Criteria - Max Iterations&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">solution_setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Flow Regime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Turbulent&quot;</span>
<span class="n">solution_setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Turbulent Model Eqn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ZeroEquation&quot;</span>
<span class="n">solution_setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Radiation Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Discrete Ordinates Model&quot;</span>
<span class="n">solution_setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Include Flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">solution_setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Include Gravity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">solution_setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Solution Initialization - Z Velocity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0.0005m_per_sec&quot;</span>
<span class="n">solution_setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Convergence Criteria - Flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0005</span>
<span class="n">solution_setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Flow Iteration Per Radiation Iteration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;5&quot;</span>
</pre></div>
</div>
</div>
</section>
<section id="Add-two-way-coupling">
<h3>Add two-way coupling<a class="headerlink" href="#Add-two-way-coupling" title="Link to this heading">#</a></h3>
<p>The temperature update from Icepak to Maxwell 3D is activated using the method <code class="docutils literal notranslate"><span class="pre">assign_2way_coupling()</span></code>. The Ohmic loss in Maxwell will change due to the temperature increase, which in turn will change the results from the Icepak simulation. By default, this iteration occurs twice. However, the named argument <code class="docutils literal notranslate"><span class="pre">number_of_iterations</span></code> can be passed to the <code class="docutils literal notranslate"><span class="pre">assign_2way_coupling</span></code> method to increase the number of iterations.</p>
<p>The full electro-thermal analysis is run by calling the <code class="docutils literal notranslate"><span class="pre">analyze_setup()</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipk</span><span class="o">.</span><span class="n">assign_2way_coupling</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="Run-Icepak-analysis">
<h3>Run Icepak analysis<a class="headerlink" href="#Run-Icepak-analysis" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipk</span><span class="o">.</span><span class="n">analyze_setup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">solution_setup</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Solving design setup Setup
PyAEDT INFO: Design setup Setup solved correctly in 0.0h 3.0m 6.0s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
</section>
<section id="Postprocess">
<h2>Postprocess<a class="headerlink" href="#Postprocess" title="Link to this heading">#</a></h2>
<p>Plot the temperature on object surfaces.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">surface_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Coil&quot;</span><span class="p">,</span> <span class="s2">&quot;Core&quot;</span><span class="p">]:</span>
    <span class="n">surface_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ipk</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_object_faces</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

<span class="n">surf_temperature</span> <span class="o">=</span> <span class="n">ipk</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_fieldplot_surface</span><span class="p">(</span>
    <span class="n">surface_list</span><span class="p">,</span> <span class="n">quantity</span><span class="o">=</span><span class="s2">&quot;SurfTemperature&quot;</span><span class="p">,</span> <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;Surface Temperature&quot;</span>
<span class="p">)</span>

<span class="n">velocity_cutplane</span> <span class="o">=</span> <span class="n">ipk</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_fieldplot_cutplane</span><span class="p">(</span>
    <span class="n">assignment</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Global:XZ&quot;</span><span class="p">],</span> <span class="n">quantity</span><span class="o">=</span><span class="s2">&quot;Velocity Vectors&quot;</span><span class="p">,</span> <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;Velocity Vectors&quot;</span>
<span class="p">)</span>

<span class="n">surf_temperature</span><span class="o">.</span><span class="n">export_image</span><span class="p">()</span>
<span class="n">velocity_cutplane</span><span class="o">.</span><span class="n">export_image</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

<span class="n">report_temp</span> <span class="o">=</span> <span class="n">ipk</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="s2">&quot;PointMonitor1.Temperature&quot;</span><span class="p">,</span> <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;X&quot;</span>
<span class="p">)</span>
<span class="n">solution_temp</span> <span class="o">=</span> <span class="n">report_temp</span><span class="o">.</span><span class="n">get_solution_data</span><span class="p">()</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">solution_temp</span><span class="o">.</span><span class="n">get_expression_data</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;magnitude&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">m3d</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;*******Coil temperature =  </span><span class="si">{:.2f}</span><span class="s2">deg C&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: PostProcessor class has been initialized! Elapsed time: 0m 0sec
PyAEDT INFO: Post class has been initialized! Elapsed time: 0m 0sec
PyAEDT INFO: Active Design set to 2 Icepak
PyAEDT INFO: Active Design set to 2 Icepak
PyAEDT WARNING: No report category provided. Automatically identified Monitor
PyAEDT INFO: Solution Data Correctly Loaded.
Time to initialize solution data:0.0
Time to initialize solution data:0.0
PyAEDT INFO: *******Coil temperature =  69.19deg C
</pre></div></div>
</div>
<section id="Get-updated-resistance-from-Maxwell-3D">
<h3>Get updated resistance from Maxwell 3D<a class="headerlink" href="#Get-updated-resistance-from-Maxwell-3D" title="Link to this heading">#</a></h3>
<p>The temperature of the coil increases, and consequently the coil resistance increases.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">report_new</span> <span class="o">=</span> <span class="n">m3d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span><span class="n">expressions</span><span class="o">=</span><span class="s2">&quot;Matrix1.R(Winding1,Winding1)&quot;</span><span class="p">)</span>
<span class="n">solution_new</span> <span class="o">=</span> <span class="n">report_new</span><span class="o">.</span><span class="n">get_solution_data</span><span class="p">()</span>
<span class="n">resistance_new</span> <span class="o">=</span> <span class="n">solution_new</span><span class="o">.</span><span class="n">get_expression_data</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;magnitude&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">resistance_increase</span> <span class="o">=</span> <span class="p">(</span><span class="n">resistance_new</span> <span class="o">-</span> <span class="n">resistance</span><span class="p">)</span> <span class="o">/</span> <span class="n">resistance</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">report_loss_new</span> <span class="o">=</span> <span class="n">m3d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span><span class="n">expressions</span><span class="o">=</span><span class="s2">&quot;StrandedLossAC&quot;</span><span class="p">)</span>
<span class="n">solution_loss_new</span> <span class="o">=</span> <span class="n">report_loss_new</span><span class="o">.</span><span class="n">get_solution_data</span><span class="p">()</span>
<span class="n">em_loss_new</span> <span class="o">=</span> <span class="n">solution_loss_new</span><span class="o">.</span><span class="n">get_expression_data</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;magnitude&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="n">m3d</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
    <span class="s2">&quot;*******Coil resistance at 150kHz AFTER temperature feedback =  </span><span class="si">{:.2f}</span><span class="s2">Ohm&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">resistance_new</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">m3d</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
    <span class="s2">&quot;*******Coil resistance increased by </span><span class="si">{:.2f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resistance_increase</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">m3d</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
    <span class="s2">&quot;*******Ohmic loss in coil AFTER temperature feedback =  </span><span class="si">{:.2f}</span><span class="s2">W&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">em_loss_new</span> <span class="o">/</span> <span class="mi">1000</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT WARNING: No report category provided. Automatically identified AC Magnetic
PyAEDT INFO: Solution Data Correctly Loaded.
Time to initialize solution data:0.0
Time to initialize solution data:0.0
PyAEDT WARNING: No report category provided. Automatically identified AC Magnetic
PyAEDT INFO: Solution Data Correctly Loaded.
Time to initialize solution data:0.0
Time to initialize solution data:0.0
PyAEDT INFO: *******Coil resistance at 150kHz AFTER temperature feedback =  2.61Ohm
PyAEDT INFO: *******Coil resistance increased by 1742655.70%
PyAEDT INFO: *******Ohmic loss in coil AFTER temperature feedback =  130.71W
</pre></div></div>
</div>
</section>
<section id="Save-the-project">
<h3>Save the project<a class="headerlink" href="#Save-the-project" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipk</span><span class="o">.</span><span class="n">save_project</span><span class="p">()</span>
<span class="n">ipk</span><span class="o">.</span><span class="n">release_desktop</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Allow AEDT to shut down before cleaning the temporary project folder.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Project Maxwell-Icepak-2way-Coupling Saved correctly
PyAEDT INFO: Desktop has been released and closed.
</pre></div></div>
</div>
</section>
<section id="Clean-up">
<h3>Clean up<a class="headerlink" href="#Clean-up" title="Link to this heading">#</a></h3>
<p>All project files are saved in the folder <code class="docutils literal notranslate"><span class="pre">temp_folder.name</span></code>. If you’ve run this example as a Jupyter notebook, you can retrieve those project files. The following cell removes all temporary files, including the project folder.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_folder</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<div class="admonition-download-this-example admonition">
<p class="admonition-title">Download this example</p>
<p>Download this example as a <a class="reference external" href="https://examples.aedt.docs.pyansys.com/version/dev/examples/low_frequency/multiphysics/maxwell_icepak.ipynb">Jupyter Notebook</a>
or as a <a class="reference external" href="https://examples.aedt.docs.pyansys.com/version/dev/examples/low_frequency/multiphysics/maxwell_icepak.py">Python script</a>.</p>
</div>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Prerequisites">Prerequisites</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Perform-imports">Perform imports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Define-constants">Define constants</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Create-temporary-directory">Create temporary directory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Launch-application">Launch application</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Model-Preparation">Model Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Build-the-model">Build the model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Restore-view">Restore view</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Create-and-assign-material">Create and assign material</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Define-the-source">Define the source</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Assign-mesh-operations">Assign mesh operations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Set-object-temperature-and-enable-feedback">Set object temperature and enable feedback</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Assign-the-matrix-calculation-to-the-winding">Assign the matrix calculation to the winding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Create-the-simulation-setup">Create the simulation setup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Run-the-Maxwell-3D-analysis">Run the Maxwell 3D analysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Postprocessing">Postprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#DC-resistance">DC resistance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Analyitic-calculation-of-DC-resistance">Analyitic calculation of DC resistance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Create-the-thermal-model">Create the thermal model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Map-coil-losses">Map coil losses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Define-boundary-conditions">Define boundary conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Assign-monitor">Assign monitor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Set-up-Icepak-solution">Set up Icepak solution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Add-two-way-coupling">Add two-way coupling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Run-Icepak-analysis">Run Icepak analysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Postprocess">Postprocess</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Get-updated-resistance-from-Maxwell-3D">Get updated resistance from Maxwell 3D</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Save-the-project">Save the project</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Clean-up">Clean up</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item"> 
<div class="tocsection editthispage">
  <a href="https://github.com/ansys/pyaedt-examples/edit/main/doc/source/examples/low_frequency/multiphysics/maxwell_icepak.ipynb">
    <i class="fa-solid fa-pencil"></i>
       Edit
    on GitHub  
  </a>
</div>

</div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../../_sources/examples/low_frequency/multiphysics/maxwell_icepak.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright (c) 2021 - 2026 ANSYS, Inc. All rights reserved.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the
  <a href="https://sphinxdocs.ansys.com/version/stable/index.html"
    >Ansys Sphinx Theme</a
  >
  1.0.11. <br />Last updated on
  <span id="date"></span>
</p>
<script>
  var options = { day: "numeric", month: "long", year: "numeric" };
  var lastModifiedDate = new Date(document.lastModified);
  var date = lastModifiedDate.toLocaleDateString("en-US", options);
  document.getElementById("date").innerHTML = date;
</script></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>