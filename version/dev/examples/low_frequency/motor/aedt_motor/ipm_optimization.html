
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>IPM geometry optimization &#8212; PyAEDT Examples</title>

  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css\ansys_sphinx_theme.css?v=d2ac875c" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" type="text/css" href="https://www.nerdfonts.com/assets/css/webfont.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/custom.css?v=9233c59b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/highlight.css?v=500661c4" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>
 
<link href="../../../../_static/css/breadcrumbs.css" rel="stylesheet" />

    <script src="../../../../_static/documentation_options.js?v=e7fb764e"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=49e1bf35"></script>
    <script src="../../../../_static/js\table.js?v=b64f5182"></script>
    <script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/low_frequency/motor/aedt_motor/ipm_optimization';</script>
    <link rel="icon" href="../../../../_static/ansys-favicon.png"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <link rel="canonical" href="https://examples.aedt.docs.pyansys.com/version/stable/examples/low_frequency/motor/aedt_motor/ipm_optimization.html" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container"><!-- Debugging: html_theme_options =  -->

  <!-- If there is no MeiliSearch enabled, use the PyData search -->
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

   
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="https://www.ansys.com/">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/ansys_logo_transparent_black.png" class="logo__image only-light" alt="PyAEDT Examples - Home"/>
    <script>document.write(`<img src="../../../../_static/ansys_logo_transparent_white.png" class="logo__image only-dark" alt="PyAEDT Examples - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyaedt-examples" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyaedt-examples/discussions" title="Support" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comment fa-fw fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Support</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
    

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyaedt-examples" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyaedt-examples/discussions" title="Support" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comment fa-fw fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Support</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">
<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
         
    <li class="breadcrumb-item breadcrumb-home">
      <a href="https://docs.pyansys.com/" class="nav-link">PyAnsys</a>
    </li>
       
    <li class="breadcrumb-item">
      <a href="https://aedt.docs.pyansys.com/" class="nav-link">PyAEDT</a>
    </li>
     
    <li class="breadcrumb-item">
      <a
        href="../../../../index.html"
        class="nav-link"
        aria-label="Home"
      >
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
      
    <li class="breadcrumb-item active" aria-current="page">IPM geometry optimization</li>
    
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="admonition-download-this-example admonition">
<p class="admonition-title">Download this example</p>
<p>Download this example as a <a class="reference external" href="https://examples.aedt.docs.pyansys.com/version/dev/examples/low_frequency/motor/aedt_motor/ipm_optimization.ipynb">Jupyter Notebook</a>
or as a <a class="reference external" href="https://examples.aedt.docs.pyansys.com/version/dev/examples/low_frequency/motor/aedt_motor/ipm_optimization.py">Python script</a>.</p>
</div>
<hr class="docutils" />
<section id="IPM-geometry-optimization">
<h1>IPM geometry optimization<a class="headerlink" href="#IPM-geometry-optimization" title="Link to this heading">#</a></h1>
<p>This example shows how to use PyAEDT to find the best machine 2D geometry to achieve high torque and low losses. The example shows how to setup an optimetrics analysis to sweep geometries for a single value of stator current angle and a varying material for the magnets. The torque and losses results are then exported in a .csv file.</p>
<p>Keywords: <strong>Maxwell 2D</strong>, <strong>transient</strong>, <strong>motor</strong>, <strong>optimization</strong>.</p>
<section id="Perform-imports-and-define-constants">
<h2>Perform imports and define constants<a class="headerlink" href="#Perform-imports-and-define-constants" title="Link to this heading">#</a></h2>
<p>Perform required imports.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">csv</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ansys.aedt.core</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ansys.aedt.core.examples.downloads</span><span class="w"> </span><span class="kn">import</span> <span class="n">download_file</span>
<br/></pre></div>
</div>
</div>
<p>Define constants.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">AEDT_VERSION</span> <span class="o">=</span> <span class="s2">&quot;2025.2&quot;</span>
<span class="n">NUM_CORES</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">NG_MODE</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Open AEDT UI when it is launched.</span>
</pre></div>
</div>
</div>
</section>
<section id="Create-temporary-directory-and-download-files">
<h2>Create temporary directory and download files<a class="headerlink" href="#Create-temporary-directory-and-download-files" title="Link to this heading">#</a></h2>
<p>Create a temporary directory where downloaded data or dumped data can be stored. If you’d like to retrieve the project data for subsequent use, the temporary folder name is given by <code class="docutils literal notranslate"><span class="pre">temp_folder.name</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_folder</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.ansys&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Download-AEDT-file-example">
<h2>Download AEDT file example<a class="headerlink" href="#Download-AEDT-file-example" title="Link to this heading">#</a></h2>
<p>Set the local temporary folder to export the AEDT file to.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aedt_file</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span>
    <span class="n">source</span><span class="o">=</span><span class="s2">&quot;maxwell_motor_optimization&quot;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;IPM_optimization.aedt&quot;</span><span class="p">,</span>
    <span class="n">local_path</span><span class="o">=</span><span class="n">temp_folder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Launch-Maxwell-2D">
<h2>Launch Maxwell 2D<a class="headerlink" href="#Launch-Maxwell-2D" title="Link to this heading">#</a></h2>
<p>Launch AEDT and Maxwell 2D after first setting up the project, the version and the graphical mode.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m2d</span> <span class="o">=</span> <span class="n">ansys</span><span class="o">.</span><span class="n">aedt</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Maxwell2d</span><span class="p">(</span>
    <span class="n">project</span><span class="o">=</span><span class="n">aedt_file</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="n">AEDT_VERSION</span><span class="p">,</span>
    <span class="n">new_desktop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">non_graphical</span><span class="o">=</span><span class="n">NG_MODE</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Parsing C:\Users\ansys\AppData\Local\Temp\tmps982u4eg.ansys\maxwell_motor_optimization\IPM_optimization.aedt.
PyAEDT INFO: Python version 3.10.11 (tags/v3.10.11:7d4cc5a, Apr  5 2023, 00:38:17) [MSC v.1929 64 bit (AMD64)].
PyAEDT INFO: PyAEDT version 0.22.dev0.
PyAEDT INFO: Initializing new Desktop session.
PyAEDT INFO: Log on console is enabled.
PyAEDT INFO: Log on file C:\Users\ansys\AppData\Local\Temp\pyaedt_ansys_f077e07f-9ff9-4337-b2e2-f2eaa15da4ea.log is enabled.
PyAEDT INFO: Log on AEDT is disabled.
PyAEDT INFO: Debug logger is disabled. PyAEDT methods will not be logged.
PyAEDT INFO: Launching PyAEDT with gRPC plugin.
PyAEDT INFO: New AEDT session is starting on gRPC port 52125.
PyAEDT INFO: File C:\Users\ansys\AppData\Local\Temp\tmps982u4eg.ansys\maxwell_motor_optimization\IPM_optimization.aedt correctly loaded. Elapsed time: 0m 0sec
PyAEDT INFO: Electronics Desktop started on gRPC port: 52125 after 11.603502750396729 seconds.
PyAEDT INFO: AEDT installation Path C:\Program Files\ANSYS Inc\v252\AnsysEM
PyAEDT INFO: Ansoft.ElectronicsDesktop.2025.2 version started with process ID 2628.
PyAEDT INFO: Project IPM_optimization has been opened.
PyAEDT INFO: Active Design set to M2D_Transient
PyAEDT INFO: Active Design set to M2D_Transient
PyAEDT INFO: Aedt Objects correctly read
</pre></div></div>
</div>
</section>
<section id="Design-variables">
<h2>Design variables<a class="headerlink" href="#Design-variables" title="Link to this heading">#</a></h2>
<p>Define the materials array to be used in the parametric sweep.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m2d</span><span class="p">[</span><span class="s2">&quot;mat_sweep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;[&quot;XG196/96_2DSF1.000_X&quot;, &quot;NdFe30&quot;, &quot;NdFe35&quot;]&#39;</span>
<span class="n">m2d</span><span class="p">[</span><span class="s2">&quot;mat_index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</section>
<section id="Assign-material-array-to-magnets">
<h2>Assign material array to magnets<a class="headerlink" href="#Assign-material-array-to-magnets" title="Link to this heading">#</a></h2>
<p>Get all magnets in the design that by default have the material <code class="docutils literal notranslate"><span class="pre">&quot;XG196/96_2DSF1.000_X&quot;</span></code> assigned. Assign the material array defined above to all magnets.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">magnets</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_objects_by_material</span><span class="p">(</span><span class="s2">&quot;XG196/96_2DSF1.000_X&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Modeler2D class has been initialized!
PyAEDT INFO: Modeler class has been initialized! Elapsed time: 0m 1sec
PyAEDT INFO: Parsing design objects. This operation can take time
PyAEDT INFO: Refreshing bodies from Object Info
PyAEDT INFO: Bodies Info Refreshed Elapsed time: 0m 0sec
PyAEDT INFO: 3D Modeler objects parsed. Elapsed time: 0m 0sec
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">mag</span> <span class="ow">in</span> <span class="n">magnets</span><span class="p">:</span>
    <span class="n">mag</span><span class="o">.</span><span class="n">material_name</span> <span class="o">=</span> <span class="s2">&quot;mat_sweep[mat_index]&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Materials class has been initialized! Elapsed time: 0m 0sec
</pre></div></div>
</div>
</section>
<section id="Add-parametric-setup">
<h2>Add parametric setup<a class="headerlink" href="#Add-parametric-setup" title="Link to this heading">#</a></h2>
<p>Add a parametric setup made up of geometry variable sweep definitions and single value for the stator current angle. Note: Step variations have been minimized to reduce the analysis time. If needed they can be increased by changing the <code class="docutils literal notranslate"><span class="pre">step</span></code> argument.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_sweep</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">parametrics</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;bridge&quot;</span><span class="p">,</span>
    <span class="n">start_point</span><span class="o">=</span><span class="s2">&quot;0.5mm&quot;</span><span class="p">,</span>
    <span class="n">variation_type</span><span class="o">=</span><span class="s2">&quot;SingleValue&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">param_sweep</span><span class="o">.</span><span class="n">add_variation</span><span class="p">(</span>
    <span class="n">sweep_variable</span><span class="o">=</span><span class="s2">&quot;din&quot;</span><span class="p">,</span>
    <span class="n">start_point</span><span class="o">=</span><span class="mi">78</span><span class="p">,</span>
    <span class="n">end_point</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">units</span><span class="o">=</span><span class="s2">&quot;mm&quot;</span><span class="p">,</span>
    <span class="n">variation_type</span><span class="o">=</span><span class="s2">&quot;LinearStep&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">param_sweep</span><span class="o">.</span><span class="n">add_variation</span><span class="p">(</span>
    <span class="n">sweep_variable</span><span class="o">=</span><span class="s2">&quot;phase_advance&quot;</span><span class="p">,</span>
    <span class="n">start_point</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
    <span class="n">units</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">,</span>
    <span class="n">variation_type</span><span class="o">=</span><span class="s2">&quot;SingleValue&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">param_sweep</span><span class="o">.</span><span class="n">add_variation</span><span class="p">(</span>
    <span class="n">sweep_variable</span><span class="o">=</span><span class="s2">&quot;Ipeak&quot;</span><span class="p">,</span> <span class="n">start_point</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">variation_type</span><span class="o">=</span><span class="s2">&quot;SingleValue&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<p>Add material variation to the parametric setup and sweep the index of the material array defined above.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_sweep</span><span class="o">.</span><span class="n">add_variation</span><span class="p">(</span>
    <span class="n">sweep_variable</span><span class="o">=</span><span class="s2">&quot;mat_index&quot;</span><span class="p">,</span>
    <span class="n">start_point</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">end_point</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">variation_type</span><span class="o">=</span><span class="s2">&quot;LinearStep&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="Alternative-way-to-add-a-parametric-setup-from-file">
<h2>Alternative way to add a parametric setup from file<a class="headerlink" href="#Alternative-way-to-add-a-parametric-setup-from-file" title="Link to this heading">#</a></h2>
<p>Suppose you have a .csv file with all the parameters to be swept defined in columns, such as:</p>
</section>
</section>
<section id="584bef8d5dd948c5908e17aa53b4655c">
<h1><img alt="" class="no-scaled-link" src="../../../../_images/param_sweep.png" style="width: 400px;" /><a class="headerlink" href="#584bef8d5dd948c5908e17aa53b4655c" title="Link to this heading">#</a></h1>
<p>You can add a parametric setup from that file using the <code class="docutils literal notranslate"><span class="pre">add_from_file</span></code> method:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># param_sweep_from_file = m2d.parametrics.add_from_file(csv_file_path)</span>
</pre></div>
</div>
</div>
<section id="Analyze-parametric-sweep">
<h2>Analyze parametric sweep<a class="headerlink" href="#Analyze-parametric-sweep" title="Link to this heading">#</a></h2>
<p>To speed up the analysis, the time step is increased in the transient setup. This can be done by modifying the <code class="docutils literal notranslate"><span class="pre">TimeStep</span></code> property of the transient setup. Note: In a real case scenario, the time step should be: <code class="docutils literal notranslate"><span class="pre">1/freq_e/360</span></code>. To simulate a real case scenario, please comment out the following line.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m2d</span><span class="o">.</span><span class="n">setups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;TimeStep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1/freq_e/45&quot;</span>
<span class="n">param_sweep</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">cores</span><span class="o">=</span><span class="n">NUM_CORES</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Project IPM_optimization Saved correctly
PyAEDT INFO: Key Desktop/ActiveDSOConfigurations/Maxwell 2D correctly changed.
PyAEDT INFO: Solving Optimetrics
PyAEDT INFO: Design setup Parametric_QHLG4F solved correctly in 0.0h 2.0m 5.0s
PyAEDT INFO: Key Desktop/ActiveDSOConfigurations/Maxwell 2D correctly changed.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="Post-processing">
<h2>Post-processing<a class="headerlink" href="#Post-processing" title="Link to this heading">#</a></h2>
<p>Create reports to get torque and loss results for all variations. Create reports with all variations and with one variable at a time held constant. This helps to visualize the influence of each variable on the torque and losses. For the first torque report the <code class="docutils literal notranslate"><span class="pre">din</span></code> variable is held constant at 78mm.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">report_torque_din_costant</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="s2">&quot;Moving1.Torque&quot;</span><span class="p">,</span>
    <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;Sweep&quot;</span><span class="p">,</span>
    <span class="n">variations</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;bridge&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;din&quot;</span><span class="p">:</span> <span class="s2">&quot;78mm&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ipeak&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phase_advance&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mat_index&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span>
    <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;Rectangular Plot&quot;</span><span class="p">,</span>
    <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;torque_din_costant&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Parsing C:\Users\ansys\AppData\Local\Temp\tmps982u4eg.ansys\maxwell_motor_optimization\IPM_optimization.aedt.
PyAEDT INFO: File C:\Users\ansys\AppData\Local\Temp\tmps982u4eg.ansys\maxwell_motor_optimization\IPM_optimization.aedt correctly loaded. Elapsed time: 0m 0sec
PyAEDT INFO: aedt file load time 0.19460010528564453
PyAEDT INFO: PostProcessor class has been initialized! Elapsed time: 0m 0sec
PyAEDT INFO: PostProcessor class has been initialized! Elapsed time: 0m 0sec
PyAEDT INFO: Post class has been initialized! Elapsed time: 0m 0sec
PyAEDT WARNING: No report category provided. Automatically identified Transient
</pre></div></div>
</div>
<p>The second torque report has the <code class="docutils literal notranslate"><span class="pre">mat_index</span></code> variable held constant at 0. In this case the material used for the magnets is <code class="docutils literal notranslate"><span class="pre">&quot;XG196/96_2DSF1.000_X&quot;</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">report_torque_mat_costant</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="s2">&quot;Moving1.Torque&quot;</span><span class="p">,</span>
    <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;Sweep&quot;</span><span class="p">,</span>
    <span class="n">variations</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;bridge&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;din&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ipeak&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phase_advance&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mat_index&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span>
    <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;Rectangular Plot&quot;</span><span class="p">,</span>
    <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;torque_mat_costant&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT WARNING: No report category provided. Automatically identified Transient
</pre></div></div>
</div>
<p>The same approach is used to create reports for solid and core losses.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">report_solid_loss_din_costant</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="s2">&quot;SolidLoss&quot;</span><span class="p">,</span>
    <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;Sweep&quot;</span><span class="p">,</span>
    <span class="n">variations</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;bridge&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;din&quot;</span><span class="p">:</span> <span class="s2">&quot;78mm&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ipeak&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phase_advance&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mat_index&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span>
    <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;Rectangular Plot&quot;</span><span class="p">,</span>
    <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;solid_loss_din_costant&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT WARNING: No report category provided. Automatically identified Transient
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">report_solid_loss_mat_costant</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="s2">&quot;SolidLoss&quot;</span><span class="p">,</span>
    <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;Sweep&quot;</span><span class="p">,</span>
    <span class="n">variations</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;bridge&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;din&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ipeak&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phase_advance&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mat_index&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span>
    <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;Rectangular Plot&quot;</span><span class="p">,</span>
    <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;solid_loss_mat_costant&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT WARNING: No report category provided. Automatically identified Transient
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">report_core_loss_din_costant</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="s2">&quot;CoreLoss&quot;</span><span class="p">,</span>
    <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;Sweep&quot;</span><span class="p">,</span>
    <span class="n">variations</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;bridge&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;din&quot;</span><span class="p">:</span> <span class="s2">&quot;78mm&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ipeak&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phase_advance&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mat_index&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span>
    <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;Rectangular Plot&quot;</span><span class="p">,</span>
    <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;core_loss_din_costant&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT WARNING: No report category provided. Automatically identified Transient
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">report_core_loss_mat_costant</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">create_report</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="s2">&quot;CoreLoss&quot;</span><span class="p">,</span>
    <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;Sweep&quot;</span><span class="p">,</span>
    <span class="n">variations</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;bridge&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;din&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ipeak&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phase_advance&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mat_index&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span>
    <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;Rectangular Plot&quot;</span><span class="p">,</span>
    <span class="n">plot_name</span><span class="o">=</span><span class="s2">&quot;core_loss_mat_costant&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT WARNING: No report category provided. Automatically identified Transient
</pre></div></div>
</div>
<p>Get torque and loss solution data for all variations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">torque_data</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">get_solution_data</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Moving1.Torque&quot;</span><span class="p">],</span>
    <span class="n">setup_sweep_name</span><span class="o">=</span><span class="n">m2d</span><span class="o">.</span><span class="n">nominal_sweep</span><span class="p">,</span>
    <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;Sweep&quot;</span><span class="p">,</span>
    <span class="n">variations</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;bridge&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;din&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ipeak&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phase_advance&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mat_index&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span>
    <span class="n">report_category</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Solution Data Correctly Loaded.
Time to initialize solution data:0.0481870174407959
Time to initialize solution data:0.0481870174407959
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solid_loss_data</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">get_solution_data</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;SolidLoss&quot;</span><span class="p">],</span>
    <span class="n">setup_sweep_name</span><span class="o">=</span><span class="n">m2d</span><span class="o">.</span><span class="n">nominal_sweep</span><span class="p">,</span>
    <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;Sweep&quot;</span><span class="p">,</span>
    <span class="n">variations</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;bridge&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;din&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ipeak&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phase_advance&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mat_index&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span>
    <span class="n">report_category</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Solution Data Correctly Loaded.
Time to initialize solution data:0.04729056358337402
Time to initialize solution data:0.0545344352722168
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">core_loss_data</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">get_solution_data</span><span class="p">(</span>
    <span class="n">expressions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;CoreLoss&quot;</span><span class="p">],</span>
    <span class="n">setup_sweep_name</span><span class="o">=</span><span class="n">m2d</span><span class="o">.</span><span class="n">nominal_sweep</span><span class="p">,</span>
    <span class="n">domain</span><span class="o">=</span><span class="s2">&quot;Sweep&quot;</span><span class="p">,</span>
    <span class="n">variations</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;bridge&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;din&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ipeak&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phase_advance&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mat_index&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">primary_sweep_variable</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span>
    <span class="n">report_category</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Solution Data Correctly Loaded.
Time to initialize solution data:0.04681134223937988
Time to initialize solution data:0.04681134223937988
</pre></div></div>
</div>
<p>Calculate torque and loss average values for each variation and write data in a .csv file.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csv_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">core_loss_data</span><span class="o">.</span><span class="n">variations</span><span class="p">:</span>
    <span class="n">torque_data</span><span class="o">.</span><span class="n">active_variation</span> <span class="o">=</span> <span class="n">var</span>
    <span class="n">core_loss_data</span><span class="o">.</span><span class="n">active_variation</span> <span class="o">=</span> <span class="n">var</span>
    <span class="n">solid_loss_data</span><span class="o">.</span><span class="n">active_variation</span> <span class="o">=</span> <span class="n">var</span>

    <span class="n">torque_values</span> <span class="o">=</span> <span class="n">torque_data</span><span class="o">.</span><span class="n">get_expression_data</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;magnitude&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">core_loss_values</span> <span class="o">=</span> <span class="n">core_loss_data</span><span class="o">.</span><span class="n">get_expression_data</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;magnitude&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">solid_loss_values</span> <span class="o">=</span> <span class="n">solid_loss_data</span><span class="o">.</span><span class="n">get_expression_data</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;magnitude&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">torque_data_average</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">torque_values</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">torque_values</span><span class="p">)</span>
    <span class="n">core_loss_average</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">core_loss_values</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">core_loss_values</span><span class="p">)</span>
    <span class="n">solid_loss_average</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">solid_loss_values</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">solid_loss_values</span><span class="p">)</span>

    <span class="n">csv_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;active_variation&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">torque_data</span><span class="o">.</span><span class="n">active_variation</span><span class="p">),</span>
            <span class="s2">&quot;average_torque&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">torque_data_average</span><span class="p">),</span>
            <span class="s2">&quot;average_core_loss&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">core_loss_average</span><span class="p">),</span>
            <span class="s2">&quot;average_solid_loss&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">solid_loss_average</span><span class="p">),</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_folder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;motor_optimization.csv&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;active_variation&quot;</span><span class="p">,</span>
            <span class="s2">&quot;average_torque&quot;</span><span class="p">,</span>
            <span class="s2">&quot;average_core_loss&quot;</span><span class="p">,</span>
            <span class="s2">&quot;average_solid_loss&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictWriter</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">fieldnames</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writeheader</span><span class="p">()</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">csv_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Release-AEDT">
<h2>Release AEDT<a class="headerlink" href="#Release-AEDT" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m2d</span><span class="o">.</span><span class="n">save_project</span><span class="p">()</span>
<span class="n">m2d</span><span class="o">.</span><span class="n">release_desktop</span><span class="p">()</span>
<span class="c1"># Wait 3 seconds to allow AEDT to shut down before cleaning the temporary directory.</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyAEDT INFO: Project IPM_optimization Saved correctly
PyAEDT INFO: Desktop has been released and closed.
</pre></div></div>
</div>
</section>
<section id="Clean-up">
<h2>Clean up<a class="headerlink" href="#Clean-up" title="Link to this heading">#</a></h2>
<p>All project files are saved in the folder <code class="docutils literal notranslate"><span class="pre">temp_folder.name</span></code>. If you’ve run this example as a Jupyter notebook, you can retrieve those project files. The following cell removes all temporary files, including the project folder.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_folder</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<div class="admonition-download-this-example admonition">
<p class="admonition-title">Download this example</p>
<p>Download this example as a <a class="reference external" href="https://examples.aedt.docs.pyansys.com/version/dev/examples/low_frequency/motor/aedt_motor/ipm_optimization.ipynb">Jupyter Notebook</a>
or as a <a class="reference external" href="https://examples.aedt.docs.pyansys.com/version/dev/examples/low_frequency/motor/aedt_motor/ipm_optimization.py">Python script</a>.</p>
</div>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">IPM geometry optimization</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Perform-imports-and-define-constants">Perform imports and define constants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Create-temporary-directory-and-download-files">Create temporary directory and download files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Download-AEDT-file-example">Download AEDT file example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Launch-Maxwell-2D">Launch Maxwell 2D</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Design-variables">Design variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Assign-material-array-to-magnets">Assign material array to magnets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Add-parametric-setup">Add parametric setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Alternative-way-to-add-a-parametric-setup-from-file">Alternative way to add a parametric setup from file</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#584bef8d5dd948c5908e17aa53b4655c"></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Analyze-parametric-sweep">Analyze parametric sweep</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Post-processing">Post-processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Release-AEDT">Release AEDT</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Clean-up">Clean up</a></li>
</ul>
</li>
</ul>

  </nav></div>

  <div class="sidebar-secondary-item"> 
<div class="tocsection editthispage">
  <a href="https://github.com/ansys/pyaedt-examples/edit/main/doc/source/examples/low_frequency/motor/aedt_motor/ipm_optimization.ipynb">
    <i class="fa-solid fa-pencil"></i>
       Edit
    on GitHub  
  </a>
</div>

</div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../../../_sources/examples/low_frequency/motor/aedt_motor/ipm_optimization.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright (c) 2021 - 2025 ANSYS, Inc. All rights reserved.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the
  <a href="https://sphinxdocs.ansys.com/version/stable/index.html"
    >Ansys Sphinx Theme</a
  >
  1.0.11. <br />Last updated on
  <span id="date"></span>
</p>
<script>
  var options = { day: "numeric", month: "long", year: "numeric" };
  var lastModifiedDate = new Date(document.lastModified);
  var date = lastModifiedDate.toLocaleDateString("en-US", options);
  document.getElementById("date").innerHTML = date;
</script></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>